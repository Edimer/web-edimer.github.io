<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Machine Learning con R y Python</title>
<link>https://blogrpy.netlify.app/index.html</link>
<atom:link href="https://blogrpy.netlify.app/index.xml" rel="self" type="application/rss+xml"/>
<description>Machine Learning con R y Python</description>
<generator>quarto-1.1.251</generator>
<lastBuildDate>Sat, 01 May 2021 05:00:00 GMT</lastBuildDate>
<item>
  <title>XGBoost con R</title>
  <dc:creator>Edimer (Sidereus)</dc:creator>
  <link>https://blogrpy.netlify.app/posts/XGBoost_R/XGBoost_R.html</link>
  <description><![CDATA[ <section id="documentación-xgboost" class="level2"><h2 class="anchored" data-anchor-id="documentación-xgboost">Documentación <code>xgboost</code>
</h2>
<ul>
<li><a href="https://xgboost.readthedocs.io/en/latest/#">Documentación oficial <code>xgboost</code></a></li>
<li><a href="https://cran.r-project.org/web/packages/xgboost/xgboost.pdf">Biblioteca <code>xgboost</code> en R</a></li>
<li><a href="https://xgboost.readthedocs.io/en/latest/R-package/xgboostPresentation.html">Tutorial de <code>xgboost</code> en R</a></li>
</ul></section><section id="datos-de-ejemplo" class="level1"><h1>Datos de ejemplo</h1>
<p>En este documento se muestra cómo implementar el algoritmo <em>XGBoost</em> con R a través de la biblioteca que lleva el mismo nombre y haciendo uso del <a href="https://www.tidymodels.org/"><code>tidymodels</code>.</a> Para ejemplificar el ajuste de <em>modelos de clasificación</em> se obtuvieron datos de ejemplo aplicado en ciencias animales, específicamente en la detección de patrones de infección de mastitis en vacas.</p>
<section id="detección-de-mastitis" class="level2"><h2 class="anchored" data-anchor-id="detección-de-mastitis">Detección de mastitis</h2>
<ul>
<li><a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0249136">Artículo publicado en PLOS ONE</a></li>
</ul>
<center>
<img src="https://blogrpy.netlify.app/posts/XGBoost_R/img/paper_classification.PNG" width="750/">
</center>
</section></section><section id="requisitos-previos" class="level1"><h1>Requisitos previos</h1>
<ul>
<li>Para replicar este documento es necesario instalar las siguientes bibliotecas:
<ul>
<li>
<strong><code>tidyverse</code>:</strong> manipulación y visualización de datos.</li>
<li>
<strong><code>readxl</code>:</strong> lectura de datos en formato de Excel.</li>
<li>
<strong><code>janitor</code>:</strong> manipulación de datos.</li>
<li>
<strong><code>visdat</code>:</strong> análisis exploratorio de datos.</li>
<li>
<strong><code>tidymodels</code>:</strong> entrenamiento y evaluación de modelos de machine learning.</li>
<li>
<strong><code>xgboost</code>:</strong> algoritmo <code>xgboost</code>.</li>
<li>
<strong><code>doParallel</code>:</strong> procesamiento en paralelo (cómputo distribuido).</li>
<li>
<strong><code>parallel</code></strong> procesamiento en paralelo (cómputo distribuido).</li>
<li>
<strong><code>vip</code>:</strong> calcular importancia de variables.</li>
<li>
<strong><code>ggsci</code>:</strong> paletas de colores.</li>
<li>
<strong><code>ggforce</code></strong> complemento para gráficos.</li>
<li>
<strong><code>FactoMineR</code>:</strong> análisis multivariado.</li>
<li>
<strong><code>knitr</code>:</strong> presentación de tablas (<code>data.frame</code>).</li>
</ul>
</li>
<li>Descargar los datos para ejemplo:
<ul>
<li><a href="https://www.nature.com/articles/s41598-020-61126-8#Sec15">Datos para detección de mastitis</a></li>
</ul>
</li>
<li>
<strong>Nota:</strong> es importante mencionar que cuando cargamos la <em>meta-biblioteca</em> <code>tidymodels</code> se activan otras bibliotecas que usaremos más adelante.</li>
</ul></section><section id="bibliotecas" class="level1"><h1>Bibliotecas</h1>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="http://visdat.njtierney.com/">visdat</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="http://factominer.free.fr">FactoMineR</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://tidymodels.tidymodels.org">tidymodels</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://github.com/dmlc/xgboost">xgboost</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://github.com/RevolutionAnalytics/doparallel">doParallel</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">parallel</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://github.com/koalaverse/vip/">vip</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://nanx.me/ggsci/">ggsci</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://ggforce.data-imaginist.com">ggforce</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details>
</div>
</section><section id="tema-para-ggplot2" class="level1"><h1>Tema para <code>ggplot2</code>
</h1>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">mi_temagg</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op" style="color: #5E5E5E;">(</span>axis.text.x <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op" style="color: #5E5E5E;">(</span>color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"black"</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>        axis.text.y <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op" style="color: #5E5E5E;">(</span>color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"black"</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>        strip.background <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op" style="color: #5E5E5E;">(</span>fill <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"gray5"</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>        strip.text <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op" style="color: #5E5E5E;">(</span>color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"white"</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">12</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>        legend.position <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"top"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">mi_temagg</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details>
</div>
</section><section id="detección-de-mastitis-1" class="level1"><h1>Detección de mastitis</h1>
<ul>
<li>La variable respuesta está identificada como <code>diagnosis</code>. En principio tiene 4 niveles, sin embargo, para el ejemplo fueron filtrados sólo los niveles <code>EDP</code> (transmisión en el período seco - sin lactancia) y <code>EL</code> (transmisión en período de lactancia).</li>
<li>La base de datos consta de 1000 observaciones y 229 variables, es decir, que existen 228 variables predictoras. Cuando se aplicó el filtro quedaron 914 observaciones.</li>
</ul>
<section id="base-de-datos" class="level2"><h2 class="anchored" data-anchor-id="base-de-datos">Base de datos</h2>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">mastitis</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"data/mastitis.csv"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">diagnosis</span> <span class="op" style="color: #5E5E5E;"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"EDP"</span>, <span class="st" style="color: #20794D;">"EL"</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;">mastitis</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">diagnosis</span>, <span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">5</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op" style="color: #5E5E5E;">(</span>caption <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"6 primeras filas de la base de datos con 6 columnas"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>6 primeras filas de la base de datos con 6 columnas</caption>
<colgroup>
<col style="width: 8%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 23%">
<col style="width: 20%">
<col style="width: 17%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">diagnosis</th>
<th style="text-align: left;">quarter_dates_q0</th>
<th style="text-align: right;">no_recordings_q0</th>
<th style="text-align: right;">l_1_q0_bmscc_000_cells_ml</th>
<th style="text-align: right;">l_1_q0_percent_chronic</th>
<th style="text-align: right;">l_1_q0_percent_200k</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">EDP</td>
<td style="text-align: left;">06/10/2009</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">EDP</td>
<td style="text-align: left;">06/12/2009</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">284</td>
<td style="text-align: right;">27.8</td>
<td style="text-align: right;">40.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EL</td>
<td style="text-align: left;">20/04/2012</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">EL</td>
<td style="text-align: left;">16/07/2009</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">222</td>
<td style="text-align: right;">21.1</td>
<td style="text-align: right;">26.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EL</td>
<td style="text-align: left;">16/10/2013</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">251</td>
<td style="text-align: right;">27.5</td>
<td style="text-align: right;">34.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">EDP</td>
<td style="text-align: left;">12/01/2013</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">154</td>
<td style="text-align: right;">12.3</td>
<td style="text-align: right;">17.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="análisis-exploratorio" class="level2"><h2 class="anchored" data-anchor-id="análisis-exploratorio">Análisis exploratorio</h2>
<ul>
<li>Frecuencia absoluta para niveles de la variable respuesta.</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">mastitis</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">diagnosis</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">diagnosis</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">n</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op" style="color: #5E5E5E;">(</span>color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"dodgerblue3"</span>, fill <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"dodgerblue3"</span>, alpha <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.8</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_label</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>label <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">n</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Diagnóstico"</span>", y<span class="op" style="color: #5E5E5E;">=</span>=<span class="st" style="color: #20794D;">"Frecuencia"</span><span class="op" style="color: #5E5E5E;">)</span>)</span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/XGBoost_R/XGBoost_R_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Frecuencia absoluta de variable respuesta</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Distribuciones de algunas variables numéricas: como el número de variables es alto, selecciono al azar 8 de ellas para construir el gráfico.</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># Números al azar</span>r</span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1992</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">variables_azar</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">228</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">8</span>, replace <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">FALSE</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;">mastitis</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">diagnosis</span>, <span class="va" style="color: #111111;">variables_azar</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op" style="color: #5E5E5E;">(</span>cols <span class="op" style="color: #5E5E5E;">=</span> <span class="op" style="color: #5E5E5E;">-</span><span class="va" style="color: #111111;">diagnosis</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">value</span>, fill <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">diagnosis</span>, color <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">diagnosis</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">~</span><span class="va" style="color: #111111;">name</span>, scales <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"free"</span>, ncol <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">4</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op" style="color: #5E5E5E;">(</span>alpha <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.8</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://nanx.me/ggsci/reference/scale_jama.html">scale_color_jama</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://nanx.me/ggsci/reference/scale_jama.html">scale_fill_jama</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">""</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Densidad"</span>, color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Diagnóstico"</span>",</span>
<span>       fill <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Diagnóstico"</span><span class="op" style="color: #5E5E5E;">)</span>)</span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/XGBoost_R/XGBoost_R_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="768"></p>
<p></p><figcaption class="figure-caption">Densidades de 8 variables al azar (transformación con logaritmo en base 10)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Verificamos si existen valores ausentes. Se observan algunas filas con valores <code>NA</code>.</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://docs.ropensci.org/visdat/reference/vis_miss.html">vis_miss</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">mastitis</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/XGBoost_R/XGBoost_R_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="768"></p>
<p></p><figcaption class="figure-caption">Valores ausentes en el conjunto de datos</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Con la finalidad de evidenciar si existe algún patrón de asociación subyacente en el total de variables, se realizó análisis de componentes principales y se grafican los dos primeros componentes. No existe algún comportamiento de agrupación al reducir la dimensión a los dos primeros componentes. Se observó que la retención de variabilidad de estas dos coordenadas apenas alcanzó el 30% aproximadamente.</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># Análisis de componentes principales</span>s</span>
<span><span class="va" style="color: #111111;">datos_pca</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">mastitis</span></span>
<span><span class="va" style="color: #111111;">pca</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html">PCA</a></span><span class="op" style="color: #5E5E5E;">(</span>X <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">datos_pca</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>             <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;">where</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">is.numeric</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>           scale.unit <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">TRUE</span>,</span>
<span>           graph <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">FALSE</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Agregando componentes a la base de datos</span></span>
<span><span class="va" style="color: #111111;">datos_pca</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">cp1</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">pca</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">ind</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">coord</span><span class="op" style="color: #5E5E5E;">[</span>, <span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">]</span></span>
<span><span class="va" style="color: #111111;">datos_pca</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">cp2</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">pca</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">ind</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">coord</span><span class="op" style="color: #5E5E5E;">[</span>, <span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">]</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Gráfico de las 2 primeras componentes</span>s</span>
<span><span class="va" style="color: #111111;">datos_pca</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">cp1</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">cp2</span>, color <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">diagnosis</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op" style="color: #5E5E5E;">(</span>yintercept <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0</span>, color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"black"</span>, linetype <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op" style="color: #5E5E5E;">(</span>xintercept <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0</span>, color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"black"</span>, linetype <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://nanx.me/ggsci/reference/scale_jama.html">scale_color_jama</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"CP1 (15.74 %)"</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"CP2 (14.09 %)"</span>, color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Diagnóstico"</span><span class="op" style="color: #5E5E5E;">)</span>)</span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/XGBoost_R/XGBoost_R_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Componente principal 1 vs componente principal 2</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Los resultados exploratorios sugieren cuatro cosas importantes:
<ul>
<li>El problema de clasificación bajo análisis podría ser denominado de <em>clases balanceadas</em>, ya que las frecuencias absolutas son similares para cada nivel a predecir.</li>
<li>Algunas variables predictoras no tienen comportamiento gaussiano. Parte de la estrategia del análisis, en estos casos, podría ser la implementación de algún tipo de transformación previo al entrenamiento de los modelos, no obstante, este paso no se aplicará dada la robustez que presenta el algoritmo <em>XGBoost</em> frente a distribuciones asimétricas.</li>
<li>Existen observaciones con valores ausentes para una o más variables. Algunos algoritmos como la <em>regresión logística</em> o los <em>bosques aleatorios</em>, no permiten la inclusión de valores <code>NA</code> al entrenar los modelos, sin embargo, con <em>XGBoost</em> no existe este inconveniente, puesto que soporta valores vacíos.</li>
<li>El análisis de componentes principales no muestra alguna tendencia de agrupación entre las clases evaluadas. La retención de variabilidad de las tres primeras componentes no supera el 50%, resultado que podría sugerir que las relaciones de tipo lineal no son plausibles en este conjunto de datos.</li>
</ul>
</li>
</ul></section><section id="train-y-test" class="level2"><h2 class="anchored" data-anchor-id="train-y-test">Train y Test</h2>
<ul>
<li>En este ejemplo los datos fueron divididos en <em>train</em> y <em>test</em> con proporciones de 80 y 20 %, respectivamente. Se utiliza muestreo estratificado en función de la variable respuesta. Se eliminaron 4 variables que tienen información de fechas; aunque podrían ser tratadas de alguna manera especial, en este caso no fueron tenidas en cuenta.</li>
<li>La biblioteca <a href="https://rsample.tidymodels.org/"><code>rsample</code></a> permite realizar la división.</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># Variables fechas</span></span>
<span><span class="va" style="color: #111111;">variables_fechas</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">mastitis</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">is.character</span>, <span class="op" style="color: #5E5E5E;">-</span><span class="va" style="color: #111111;">diagnosis</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Datos para modelos</span></span>
<span><span class="va" style="color: #111111;">data_modelos</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">mastitis</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">-</span><span class="va" style="color: #111111;">variables_fechas</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1992</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">particiones</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;">initial_split</span><span class="op" style="color: #5E5E5E;">(</span>data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">data_modelos</span>, prop <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.80</span>, strata <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">diagnosis</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">train</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;">training</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">particiones</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">test</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;">testing</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">particiones</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details>
</div>
<ul>
<li>Podemos ver el objeto <code>particiones</code> que proporciona información de la partición de datos. Los modelos son entrenados con 733 observaciones y con 181 se evalúa el desempeño de los mismos.</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">particiones</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&lt;Training/Testing/Total&gt;
&lt;731/183/914&gt;</code></pre>
</div>
</div>
</section><section id="validación-cruzada" class="level2"><h2 class="anchored" data-anchor-id="validación-cruzada">Validación cruzada</h2>
<ul>
<li>Se utiliza validación cruzada <em>k-fold</em> con <img src="https://latex.codecogs.com/png.latex?k%20=%2010">.</li>
<li>La biblioteca <a href="https://rsample.tidymodels.org/"><code>rsample</code></a> permite configurar diferentes métodos de validación cruzada.</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1992</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">config_cv</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;">vfold_cv</span><span class="op" style="color: #5E5E5E;">(</span>data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">train</span>, v <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">10</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details>
</div>
</section><section id="preprocesamiento" class="level2"><h2 class="anchored" data-anchor-id="preprocesamiento">Preprocesamiento</h2>
<ul>
<li>En este ejemplo no se hará énfasis en las estrategias de preprocesamiento o ingeniería de características, sin embargo, serán comparados algoritmos con imputación de valores ausentes (con método k vecinos más cercanos) respecto a algoritmos sin imputación.</li>
<li>La biblioteca <a href="https://recipes.tidymodels.org/"><code>recipes</code></a> permite realizar múltiples tareas de preprocesamiento e ingeniería de características.</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">no_impute</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;">recipe</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">diagnosis</span> <span class="op" style="color: #5E5E5E;">~</span> <span class="va" style="color: #111111;">.</span>, data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">train</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">si_impute</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;">recipe</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">diagnosis</span> <span class="op" style="color: #5E5E5E;">~</span> <span class="va" style="color: #111111;">.</span>, data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">train</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;">step_impute_knn</span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;">all_predictors</span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details>
</div>
</section><section id="modelo-xgboost" class="level2"><h2 class="anchored" data-anchor-id="modelo-xgboost">Modelo XGBoost</h2>
<ul>
<li>El algoritmo <em>XGboost</em> tiene múltiples hiperparámetros que pueden ser sintonizados, sin embargo, en este ejemplo sólo ser hará tuning sobre los siguientes:
<ul>
<li>
<code>mtry</code>: número de predictores que se muestrearán aleatoriamente en cada división al crear los modelos.</li>
<li>
<code>min_n</code>: número mínimo de observaciones requeridas en un nodo para que se produzca la división.</li>
<li>
<code>tree_depth</code>: profundidad máxima del árbol (número de divisiones).</li>
</ul>
</li>
<li>El número de árboles (<code>trees</code>) se estableció en 1000.</li>
<li>La tasa de aprendizaje (<code>learn_rate</code>) se estableció en 0.1.</li>
<li>La proporción de observaciones muestreadas (<code>sample_size</code>) en cada rutina de ajuste se estableció en 0.8.</li>
<li>Los demás hiperparámetros se mantienen por defecto.</li>
<li>Para más información acerca de los hiperparámetros que permite ajustar <a href="https://parsnip.tidymodels.org/"><code>parsnip</code></a>, consultar <a href="https://parsnip.tidymodels.org/reference/boost_tree.html">este enlace.</a>
</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">modelo_xgboost</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;">boost_tree</span><span class="op" style="color: #5E5E5E;">(</span>mtry <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;">tune</span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>                             min_n <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;">tune</span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>                             tree_depth <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;">tune</span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>                             trees <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1000</span>,</span>
<span>                             learn_rate <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.1</span>,</span>
<span>                             sample_size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.8</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;">set_engine</span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"xgboost"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;">set_mode</span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"classification"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details>
</div>
</section><section id="flujos-de-trabajo-pipelines" class="level2"><h2 class="anchored" data-anchor-id="flujos-de-trabajo-pipelines">Flujos de trabajo (<em>pipelines</em>)</h2>
<ul>
<li><p>Los flujos de trabajo son una manera flexible de trabajar con <em>tidymodels</em>. Se fundamenta en la misma idea de los <em>pipelines</em> de <a href="https://scikit-learn.org/stable/">scikit-learn</a> de Python. Es posible construir nuestro flujo de trabajo con recetas y modelos declarados previamente.</p></li>
<li><p>Consultar más información de la biblioteca <a href="https://workflows.tidymodels.org/">workflows.</a></p></li>
<li><p>Flujo de trabajo sin imputación:</p></li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">wf_no_impute</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;">workflow</span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;">add_recipe</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">no_impute</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;">add_model</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">modelo_xgboost</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details>
</div>
<ul>
<li>Flujo de trabajo con imputación:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">wf_si_impute</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;">workflow</span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;">add_recipe</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">si_impute</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;">add_model</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">modelo_xgboost</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details>
</div>
</section><section id="grid" class="level2"><h2 class="anchored" data-anchor-id="grid">Grid</h2>
<ul>
<li>En este caso se utiliza la cuadrícula a través de diseños de llenado de espacio (<em>space-filling designs</em>), los cuales intentan encontrar una configuración de puntos (combinaciones) que cubren el espacio de parámetros con menor probabilidad de valores que se traslapan. Para este ejemplo el tamaño de la cuadrícula fue de 10.</li>
<li>Para este caso particular se usan diseños de máxima entropía, descritos en el año 1987 por Shewry y Wynn en el artículo <em>“Maximum Entropy Sampling”.</em> También podrían ser implementados diseños de hipercubos latinos o diseños de proyección máxima. Si no se desea utilizar alguno de estos métodos, podría ser implementada una cuadrícula regular a través de métodos aleatorios (<em>grid random</em>).</li>
<li>Mayor información en la página web de la biblioteca <a href="https://dials.tidymodels.org/index.html">dials.</a>
</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># Parámetros para tuning</span>g</span>
<span><span class="va" style="color: #111111;">params_xgb</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;">parameters</span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>  <span class="fu" style="color: #4758AB;">finalize</span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;">mtry</span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span>, x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">train</span><span class="op" style="color: #5E5E5E;">[</span>, <span class="op" style="color: #5E5E5E;">-</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">]</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>  <span class="fu" style="color: #4758AB;">min_n</span><span class="op" style="color: #5E5E5E;">(</span>range <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">2L</span>, <span class="fl" style="color: #AD0000;">50L</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>  <span class="fu" style="color: #4758AB;">tree_depth</span><span class="op" style="color: #5E5E5E;">(</span>range <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">3L</span>, <span class="fl" style="color: #AD0000;">8L</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Grid</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">2021</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">grid_xgb</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">params_xgb</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;">grid_max_entropy</span><span class="op" style="color: #5E5E5E;">(</span>size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">10</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details>
</div>
<ul>
<li>A continuación se muestra la cuadrícula de búsqueda de los mejores hiperparámetros. Se evidencia que los puntos no se solapan, de tal manera que el espacio de búsqueda no es redundante.</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">grid_xgb</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">.panel_x</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">.panel_y</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggforce.data-imaginist.com/reference/facet_matrix.html">facet_matrix</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">mtry</span>, <span class="va" style="color: #111111;">min_n</span>, <span class="va" style="color: #111111;">tree_depth</span><span class="op" style="color: #5E5E5E;">)</span>, layer.diag <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/XGBoost_R/XGBoost_R_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Cuadrícula de tamaño 10 con método de máxima entropía</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="tuning-con-tidymodels" class="level2"><h2 class="anchored" data-anchor-id="tuning-con-tidymodels">Tuning con <code>tidymodels</code>
</h2>
<ul>
<li>La función <code>tune_grid()</code> de la biblioteca <a href="https://tune.tidymodels.org/">tune</a> permite evaluar los modelos con cada combinación de paramétros establecidos previamente en la cuadrícula.</li>
<li>Tuning sin imputación:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html">registerDoParallel</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;">parallel</span><span class="fu" style="color: #4758AB;">::</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">-</span> <span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">)</span> <span class="co" style="color: #5E5E5E;"># Inicio Paralelización</span>n</span>
<span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">2021</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">tuned_no_impute</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;">tune_grid</span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>  object <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">wf_no_impute</span>,</span>
<span>  resamples <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">config_cv</span>,</span>
<span>  grid <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">grid_xgb</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html">stopImplicitCluster</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="co" style="color: #5E5E5E;"># Fin Paralelización</span>n</span></code></pre></div>
</details>
</div>
<ul>
<li>Tuning con imputación:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html">registerDoParallel</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;">parallel</span><span class="fu" style="color: #4758AB;">::</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">-</span> <span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">)</span> <span class="co" style="color: #5E5E5E;"># Inicio Paralelización</span>n</span>
<span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">2021</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">tuned_si_impute</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;">tune_grid</span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>  object <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">wf_si_impute</span>,</span>
<span>  resamples <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">config_cv</span>,</span>
<span>  grid <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">grid_xgb</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html">stopImplicitCluster</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="co" style="color: #5E5E5E;"># Fin Paralelización</span>n</span></code></pre></div>
</details>
</div>
<div class="cell">

</div>
</section><section id="resultados-accuracy" class="level2"><h2 class="anchored" data-anchor-id="resultados-accuracy">Resultados <em>Accuracy</em>
</h2>
<ul>
<li>Resultados de <em>Accuracy</em> en modelos sin imputación. La precisión más alta se consigue con aproximadamente 150 variables (<code>mtry</code>), menos de 10 observaciones para que se produzca la división del árbol (<code>min_n</code>) y profunidad de más o menos 6 (<code>tree_depth</code>).</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">tuned_no_impute</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;">collect_metrics</span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">.metric</span> <span class="op" style="color: #5E5E5E;">==</span> <span class="st" style="color: #20794D;">"accuracy"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">mtry</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">min_n</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">tree_depth</span>, color <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">mean</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;">(</span>color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Accuracy"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<p><img src="https://blogrpy.netlify.app/posts/XGBoost_R/XGBoost_R_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>Resultados de <em>Accuracy</em> en modelos con imputación. La precisión más alta se consigue con aproximadamente 25 variables (<code>mtry</code>), poco menos de 50 observaciones para que se produzca la división del árbol (<code>min_n</code>) y profunidad de más o menos 4 (<code>tree_depth</code>).</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">tuned_si_impute</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;">collect_metrics</span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">.metric</span> <span class="op" style="color: #5E5E5E;">==</span> <span class="st" style="color: #20794D;">"accuracy"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">mtry</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">min_n</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">tree_depth</span>, color <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">mean</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;">(</span>color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Accuracy"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<p><img src="https://blogrpy.netlify.app/posts/XGBoost_R/XGBoost_R_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>Se observa que los mejores hiperparámetros para los algoritmos entrenados con y sin imputación, discrepan considerablemente. Aunque en este caso realicé la evaluación del desempeño de los modelos basado en la métrica <em>Accuracy</em>, es posible utilizar cualquier otra para problemas de clasificación.</li>
</ul></section><section id="mejores-hiperparámetros" class="level2"><h2 class="anchored" data-anchor-id="mejores-hiperparámetros">Mejores hiperparámetros</h2>
<ul>
<li>Mejores hiperparámetros en modelos sin imputación:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">mejor_no_impute</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">tuned_no_impute</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;">select_best</span><span class="op" style="color: #5E5E5E;">(</span>metric <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"accuracy"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;">mejor_no_impute</span></span></code></pre></div>
</details><div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["mtry"],"name":[1],"type":["int"],"align":["right"]},{"label":["min_n"],"name":[2],"type":["int"],"align":["right"]},{"label":["tree_depth"],"name":[3],"type":["int"],"align":["right"]},{"label":[".config"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"149","2":"9","3":"7","4":"Preprocessor1_Model09"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li>Mejores hiperparámetros en modelos con imputación:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">mejor_si_impute</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">tuned_si_impute</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;">select_best</span><span class="op" style="color: #5E5E5E;">(</span>metric <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"accuracy"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;">mejor_si_impute</span></span></code></pre></div>
</details><div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["mtry"],"name":[1],"type":["int"],"align":["right"]},{"label":["min_n"],"name":[2],"type":["int"],"align":["right"]},{"label":["tree_depth"],"name":[3],"type":["int"],"align":["right"]},{"label":[".config"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"25","2":"49","3":"5","4":"Preprocessor1_Model01"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="ajuste-final" class="level2"><h2 class="anchored" data-anchor-id="ajuste-final">Ajuste final</h2>
<ul>
<li>Modelo sin imputación:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">final_no_impute</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;">finalize_workflow</span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>  x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">wf_no_impute</span>,</span>
<span>  parameters <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">mejor_no_impute</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;">fit</span><span class="op" style="color: #5E5E5E;">(</span>data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">train</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details>
</div>
<ul>
<li>Modelo con imputación:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">final_si_impute</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;">finalize_workflow</span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>  x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">wf_si_impute</span>,</span>
<span>  parameters <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">mejor_si_impute</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;">fit</span><span class="op" style="color: #5E5E5E;">(</span>data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">train</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details>
</div>
</section><section id="predicciones-train" class="level2"><h2 class="anchored" data-anchor-id="predicciones-train">Predicciones Train</h2>
<ul>
<li>Modelo sin imputación:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">pred_no_impute_train</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">final_no_impute</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;">(</span>new_data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">train</span>, type <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"class"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details>
</div>
<ul>
<li>Modelo con imputación:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">pred_si_impute_train</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">final_si_impute</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;">(</span>new_data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">train</span>, type <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"class"</span><span class="op" style="color: #5E5E5E;">)</span> </span></code></pre></div>
</details>
</div>
</section><section id="predicciones-test" class="level2"><h2 class="anchored" data-anchor-id="predicciones-test">Predicciones Test</h2>
<ul>
<li>Modelo sin imputación:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">pred_no_impute_test</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">final_no_impute</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;">(</span>new_data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">test</span>, type <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"class"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details>
</div>
<ul>
<li>Modelo con imputación:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">pred_si_impute_test</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">final_si_impute</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;">(</span>new_data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">test</span>, type <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"class"</span><span class="op" style="color: #5E5E5E;">)</span> </span></code></pre></div>
</details>
</div>
</section><section id="matriz-de-confusión-train" class="level2"><h2 class="anchored" data-anchor-id="matriz-de-confusión-train">Matriz de confusión Train</h2>
<ul>
<li>Matriz de confusión modelo sin imputación:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>  predicho <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">pred_no_impute_train</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">.pred_class</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>  real <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">train</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">diagnosis</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;">conf_mat</span><span class="op" style="color: #5E5E5E;">(</span>truth <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">real</span>, estimate <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">predicho</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://purrr.tidyverse.org/reference/pluck.html">pluck</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span>  <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">Prediction</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">Truth</span>, alpha <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">n</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op" style="color: #5E5E5E;">(</span>show.legend <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">FALSE</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>label <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">n</span><span class="op" style="color: #5E5E5E;">)</span>, colour <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"white"</span>, alpha <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">8</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/XGBoost_R/XGBoost_R_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Matriz de confusión en train - modelo sin imputación</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Matriz de confusión modelo con imputación:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb31" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>  predicho <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">pred_si_impute_train</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">.pred_class</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>  real <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">train</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">diagnosis</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;">conf_mat</span><span class="op" style="color: #5E5E5E;">(</span>truth <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">real</span>, estimate <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">predicho</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://purrr.tidyverse.org/reference/pluck.html">pluck</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span>  <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">Prediction</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">Truth</span>, alpha <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">n</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op" style="color: #5E5E5E;">(</span>show.legend <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">FALSE</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>label <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">n</span><span class="op" style="color: #5E5E5E;">)</span>, colour <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"white"</span>, alpha <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">8</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/XGBoost_R/XGBoost_R_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Matriz de confusión en train - modelo con imputación</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="matriz-de-confusión-test" class="level2"><h2 class="anchored" data-anchor-id="matriz-de-confusión-test">Matriz de confusión Test</h2>
<ul>
<li>Matriz de confusión modelo sin imputación:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb32" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>  predicho <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">pred_no_impute_test</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">.pred_class</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>  real <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">test</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">diagnosis</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;">conf_mat</span><span class="op" style="color: #5E5E5E;">(</span>truth <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">real</span>, estimate <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">predicho</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://purrr.tidyverse.org/reference/pluck.html">pluck</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span>  <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">Prediction</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">Truth</span>, alpha <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">n</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op" style="color: #5E5E5E;">(</span>show.legend <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">FALSE</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>label <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">n</span><span class="op" style="color: #5E5E5E;">)</span>, colour <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"white"</span>, alpha <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">8</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/XGBoost_R/XGBoost_R_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Matriz de confusión en test - modelo sin imputación</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Matriz de confusión modelo con imputación:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb33" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>  predicho <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">pred_si_impute_test</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">.pred_class</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>  real <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">test</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">diagnosis</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;">conf_mat</span><span class="op" style="color: #5E5E5E;">(</span>truth <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">real</span>, estimate <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">predicho</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://purrr.tidyverse.org/reference/pluck.html">pluck</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span>  <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">Prediction</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">Truth</span>, alpha <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">n</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op" style="color: #5E5E5E;">(</span>show.legend <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">FALSE</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>label <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">n</span><span class="op" style="color: #5E5E5E;">)</span>, colour <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"white"</span>, alpha <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">8</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/XGBoost_R/XGBoost_R_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Matriz de confusión en test - modelo con imputación</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="desempeño-de-modelos" class="level2"><h2 class="anchored" data-anchor-id="desempeño-de-modelos">Desempeño de modelos</h2>
<ul>
<li>Genero una base de datos con los resultados de las clases predichas en cada tipo de modelo (con y sin imputación) para los conjuntos de entrenamiento y prueba.</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb34" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">tabla_accuracy</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>  predicho <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pred_no_impute_train</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">.pred_class</span>,</span>
<span>  real <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">train</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">diagnosis</span>,</span>
<span>  datos <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Train"</span>,</span>
<span>  tipo <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Sin imputación"</span>"</span>
<span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>      predicho <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pred_si_impute_train</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">.pred_class</span>,</span>
<span>      real <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">train</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">diagnosis</span>,</span>
<span>      datos <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Train"</span>,</span>
<span>      tipo <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Con imputación"</span>"</span>
<span>    <span class="op" style="color: #5E5E5E;">)</span></span>
<span>  <span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>      predicho <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pred_no_impute_test</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">.pred_class</span>,</span>
<span>      real <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">test</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">diagnosis</span>,</span>
<span>      datos <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Test"</span>,</span>
<span>      tipo <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Sin imputación"</span>"</span>
<span>    <span class="op" style="color: #5E5E5E;">)</span></span>
<span>  <span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>      predicho <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pred_si_impute_test</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">.pred_class</span>,</span>
<span>      real <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">test</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">diagnosis</span>,</span>
<span>      datos <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Test"</span>,</span>
<span>      tipo <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Con imputación"</span>"</span>
<span>    <span class="op" style="color: #5E5E5E;">)</span></span>
<span>  <span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;">where</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">is.character</span><span class="op" style="color: #5E5E5E;">)</span>, <span class="va" style="color: #111111;">as.factor</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;">tabla_accuracy</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">datos</span>, <span class="va" style="color: #111111;">tipo</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op" style="color: #5E5E5E;">(</span>accuracy <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;">accuracy_vec</span><span class="op" style="color: #5E5E5E;">(</span>truth <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">real</span>, estimate <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">predicho</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op" style="color: #5E5E5E;">(</span>caption <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Accuracy en train y test para dos modelos XGBoost"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Accuracy en train y test para dos modelos XGBoost</caption>
<thead><tr class="header">
<th style="text-align: left;">datos</th>
<th style="text-align: left;">tipo</th>
<th style="text-align: right;">accuracy</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Test</td>
<td style="text-align: left;">Con imputación</td>
<td style="text-align: right;">0.7540984</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test</td>
<td style="text-align: left;">Sin imputación</td>
<td style="text-align: right;">0.7814208</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Train</td>
<td style="text-align: left;">Con imputación</td>
<td style="text-align: right;">0.8481532</td>
</tr>
<tr class="even">
<td style="text-align: left;">Train</td>
<td style="text-align: left;">Sin imputación</td>
<td style="text-align: right;">0.9972640</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>Gráfico <em>Accuracy:</em> la capacidad predictiva es superior en el modelo que fue entrenado sin acudir a la imputación de datos.</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb35" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">tabla_accuracy</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">datos</span>, <span class="va" style="color: #111111;">tipo</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op" style="color: #5E5E5E;">(</span>accuracy <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;">accuracy_vec</span><span class="op" style="color: #5E5E5E;">(</span>truth <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">real</span>, estimate <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">predicho</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">tipo</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">accuracy</span>, color <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">datos</span>, fill <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">datos</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op" style="color: #5E5E5E;">(</span>position <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"dodge"</span>, alpha <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.8</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://nanx.me/ggsci/reference/scale_jama.html">scale_color_jama</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://nanx.me/ggsci/reference/scale_jama.html">scale_fill_jama</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Preprocesamiento"</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Accuracy"</span>,</span>
<span>       color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">""</span>, fill <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">""</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/XGBoost_R/XGBoost_R_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Accuracy en train y test para dos modelos XGBoost</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="importancia-de-variables" class="level2"><h2 class="anchored" data-anchor-id="importancia-de-variables">Importancia de variables</h2>
<ul>
<li>10 variables de mayor importancia en modelo sin imputación:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb36" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">final_no_impute</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;">pull_workflow_fit</span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/vip/man/vip.html">vip</a></span><span class="op" style="color: #5E5E5E;">(</span>geom <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"point"</span>, n <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">10</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/XGBoost_R/XGBoost_R_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Importancia de variables - modelo sin imputación</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ul>
<li>10 variables de mayor importancia en modelo sin imputación:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb37" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">final_si_impute</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;">pull_workflow_fit</span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/vip/man/vip.html">vip</a></span><span class="op" style="color: #5E5E5E;">(</span>geom <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"point"</span>, n <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">10</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/XGBoost_R/XGBoost_R_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Importancia de variables - modelo con imputación</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section></section><section id="referencias" class="level1"><h1>Referencias</h1>
<ul>
<li>Hyde, R.M., Down, P.M., Bradley, A.J. et al.&nbsp;<em>“Automated prediction of mastitis infection patterns in dairy herds using machine learning”</em>. Sci Rep 10, 4289 (2020). https://doi.org/10.1038/s41598-020-61126-8</li>
<li>Chen Tianqi, Guestrin Carlos. <em>“XGBoost: A Scalable Tree Boosting System”</em>. CoRR, Vol 1603.02754 (2016). https://arxiv.org/abs/1603.02754</li>
<li>Boehmke Bradley, Greenwell Brandon. <em>“Hands-On Machine Learning with R”</em>. Chapman and Hall/CRC (2019). https://bradleyboehmke.github.io/HOML/gbm.html</li>
<li>Shewry, M, and H Wynn. <em>“Maximum Entropy Sampling.”</em> Journal of Applied Statistics 14 (2): 165–70 (1987). https://doi.org/10.1080/02664768700000020</li>
<li>Kuhn Max, Silge Julia. <em>“Tidy Modeling with R”</em>. (2020). https://www.tmwr.org/</li>
</ul>


<!-- -->

</section> ]]></description>
  <category>R</category>
  <category>xgboost</category>
  <category>Gradient Boosting</category>
  <category>ML</category>
  <guid>https://blogrpy.netlify.app/posts/XGBoost_R/XGBoost_R.html</guid>
  <pubDate>Sat, 01 May 2021 05:00:00 GMT</pubDate>
  <media:content url="https://blogrpy.netlify.app/posts/XGBoost_R/img2.png " medium="image"/>
</item>
<item>
  <title>Árbol de clasificación con R</title>
  <dc:creator>Edimer (Sidereus)</dc:creator>
  <link>https://blogrpy.netlify.app/posts/tree_decision/TreeD_R.html</link>
  <description><![CDATA[ <center>
<img src="https://blogrpy.netlify.app/posts/tree_decision/www/img2.png">
</center>
<section id="contenido" class="level1"><h1>Contenido</h1>
<p><strong>1.</strong> Información general (requisitos previos, bibliotecas, etc).<br><strong>2.</strong> Análisis inicial de los datos. Como el objetivo principal del documento es entrenar un modelo de <em>árbol de decisión</em> con R, el análisis inicial incluye sólo una parte exploratoria y algunas pruebas estadísticas.<br><strong>3.</strong> Entrenamiento de modelo por defecto con <code>rpart</code>.<br><strong>4.</strong> Ajuste de hiperparámetros con la biblioteca <code>caret</code>. La métrica para evaluar el desempeño predictivo de los modelos es el <a href="https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5">área bajo la curva ROC.</a><br><strong>5.</strong> Material complementario.<br><strong>6.</strong> Recursos de información.</p>
</section><section id="requisitos-previos" class="level1"><h1>Requisitos previos</h1>
<ul>
<li>Instalar las bibliotecas <a href="https://cran.r-project.org/web/packages/rpart/rpart.pdf"><code>rpart</code></a> y <a href="https://cran.r-project.org/web/packages/rpart.plot/rpart.plot.pdf">rpart.plot</a> para entrenar y gráficar modelos basados en árboles.</li>
<li>Instalar la biblioteca <a href="http://topepo.github.io/caret/index.html"><code>caret</code>.</a>
</li>
<li>
<a href="https://www.openml.org/d/31">Descargar datos para ejemplo</a> desde la página <a href="https://www.openml.org/">openML</a>. La base de datos proporciona información de personas perfiladas con riesgo crediticio <em>bueno</em> o <em>malo</em>.</li>
<li>
<strong>Bibliotecas complementarias:</strong> para visualizaciones <strong><code>ggplot2</code></strong>, <strong><code>jcolors</code></strong> y <strong><code>hrbrthemes</code></strong>, para manejo de datos <strong><code>dplyr</code></strong> y para métricas de error y/o precisión <strong><code>Metrics</code></strong> y <strong><code>pROC</code></strong>.</li>
</ul></section><section id="bibliotecas" class="level1"><h1>Bibliotecas</h1>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://jaredhuling.github.io/jcolors/">jcolors</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="http://github.com/hrbrmstr/hrbrthemes">hrbrthemes</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://github.com/bethatkinson/rpart">rpart</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="http://www.milbo.org/rpart-plot/index.html">rpart.plot</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://github.com/topepo/caret/">caret</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://github.com/mfrasco/Metrics">Metrics</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="http://expasy.org/tools/pROC/">pROC</a></span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details>
</div>
</section><section id="descripción-de-variables" class="level1"><h1>Descripción de variables</h1>
<ul>
<li>Además de la variable respuesta <em>class</em>, se cuenta con las siguientes 20 variables.</li>
</ul>
<center>
<img src="https://blogrpy.netlify.app/posts/tree_decision/www/img1.png">
</center>
</section><section id="datos" class="level1"><h1>Datos</h1>
<ul>
<li>Se importan los datos y se aplica la función <code><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_if()</a></code> para eliminar las comillas simples (<em>’’</em>) que están presentes en las variables tipo texto (<code>character</code>). A continuación sólo se muestran 5 variables (columnas) con 10 observaciones. La variable <strong><code>class</code></strong> es nuestro <em>target</em> o <em>variable respuesta</em>.</li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">data</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;">data.table</span><span class="fu" style="color: #4758AB;">::</span><span class="fu" style="color: #4758AB;"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html">fread</a></span><span class="op" style="color: #5E5E5E;">(</span>file <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"data/dataset_31_credit-g.csv"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_if</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">is.character</span>, <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/funs.html">funs</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"'"</span>, <span class="st" style="color: #20794D;">""</span>, <span class="va" style="color: #111111;">.</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">data</span><span class="op" style="color: #5E5E5E;">[</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">10</span>, <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span>, <span class="fl" style="color: #AD0000;">5</span>, <span class="fl" style="color: #AD0000;">10</span>, <span class="fl" style="color: #AD0000;">15</span>, <span class="fl" style="color: #AD0000;">21</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">]</span>, n <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">10L</span><span class="op" style="color: #5E5E5E;">)</span> <span class="co" style="color: #5E5E5E;"># Imprimiendo sólo 5 columnas</span>s</span></code></pre></div>
</details><div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["checking_status"],"name":[1],"type":["chr"],"align":["left"]},{"label":["credit_amount"],"name":[2],"type":["int"],"align":["right"]},{"label":["other_parties"],"name":[3],"type":["chr"],"align":["left"]},{"label":["housing"],"name":[4],"type":["chr"],"align":["left"]},{"label":["class"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"<0","2":"1169","3":"none","4":"own","5":"good"},{"1":"0<=X<200","2":"5951","3":"none","4":"own","5":"bad"},{"1":"no checking","2":"2096","3":"none","4":"own","5":"good"},{"1":"<0","2":"7882","3":"guarantor","4":"for free","5":"good"},{"1":"<0","2":"4870","3":"none","4":"for free","5":"bad"},{"1":"no checking","2":"9055","3":"none","4":"for free","5":"good"},{"1":"no checking","2":"2835","3":"none","4":"own","5":"good"},{"1":"0<=X<200","2":"6948","3":"none","4":"rent","5":"good"},{"1":"no checking","2":"3059","3":"none","4":"own","5":"good"},{"1":"0<=X<200","2":"5234","3":"none","4":"own","5":"bad"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li><strong>Dimensión de la base de datos:</strong></li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">data</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1000   21</code></pre>
</div>
</div>
</section><section id="distribución-de-variable-respuesta" class="level1"><h1>Distribución de variable respuesta</h1>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">data</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span>mapping <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">class</span>, fill <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">class</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op" style="color: #5E5E5E;">(</span>color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"black"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op" style="color: #5E5E5E;">(</span>values <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"#5A5156"</span>, <span class="st" style="color: #20794D;">"#F6222E"</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/hrbrthemes/man/theme_ipsum.html">theme_ipsum</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op" style="color: #5E5E5E;">(</span>legend.position <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"none"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/tree_decision/TreeD_R_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="exploratorio" class="level1"><h1>Exploratorio</h1>
<ul>
<li>
<strong>Distribución de edad por variable objetivo:</strong> se puede apreciar que la edad promedio de los clasificados como <em>“buenos”</em> es más alta, además, los clasificados como <em>“malos”</em> en su mayoría son personas entre 20 y 30 años de edad.</li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">data</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span>mapping <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">class</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">age</span>, fill <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">class</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op" style="color: #5E5E5E;">(</span>color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"#E4E1E3"</span>, width <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.1</span>, show.legend <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">FALSE</span><span class="op" style="color: #5E5E5E;">)</span>  <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op" style="color: #5E5E5E;">(</span>fun.y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">mean</span>, color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"#E4E1E3"</span>, pch <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">17</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op" style="color: #5E5E5E;">(</span>values <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"#5A5156"</span>, <span class="st" style="color: #20794D;">"#F6222E"</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/hrbrthemes/man/theme_ipsum.html">theme_ipsum</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op" style="color: #5E5E5E;">(</span>legend.position <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"none"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;">(</span>caption <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"El triángulo representa el promedio."</span><span class="op" style="color: #5E5E5E;">)</span>)</span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/tree_decision/TreeD_R_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>
<strong>Propósitos de crédito más frecuentes:</strong> la distribución de personas clasificadas como <em>buenas</em> o <em>malas</em> cuando el propósito es vehículo, discrepa bastante entre la opción de <strong>nuevo</strong> o <strong>usado</strong>. En vehículos usados la gran mayoría son clasificados como “buenos”, sin embargo, cuando se trata de vehículos nuevos, la distribución es similar, lo que permite inferir que es más probable que una persona se comporte como mal pagador en créditos para vehículo nuevo respecto a créditos para vehículos usados. También se podría intuir que cuando se trata de créditos para educación es igual de probable que la persona sea clasificada como “bueno” o “malo”.</li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">data</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">class</span>, <span class="va" style="color: #111111;">purpose</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span>mapping <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">purpose</span>, <span class="va" style="color: #111111;">n</span><span class="op" style="color: #5E5E5E;">)</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">n</span>, fill <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">class</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op" style="color: #5E5E5E;">(</span>color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"#E4E1E3"</span>, position <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"dodge"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op" style="color: #5E5E5E;">(</span>values <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"#5A5156"</span>, <span class="st" style="color: #20794D;">"#F6222E"</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Purpose"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/hrbrthemes/man/theme_ipsum.html">theme_ipsum</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op" style="color: #5E5E5E;">(</span>legend.position <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"top"</span>,</span>
<span>        axis.text.x <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op" style="color: #5E5E5E;">(</span>angle <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">45</span>, hjust <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/tree_decision/TreeD_R_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="inferencia" class="level1"><h1>Inferencia</h1>
<ul>
<li>
<strong>Análisis de varianza:</strong> en vista de la discrepancia que se observa en la distribución de las edades para personas clasificadas como “buenas” o “malas”, realizo el <a href="https://es.wikipedia.org/wiki/An%C3%A1lisis_de_la_varianza">análisis de varianza</a> para contrastar si dichas diferencias son estadísticamente significativas. <strong>Nota:</strong> aunque nuestra variable respuesta es <em>class</em>, en este caso actúa como “predictora” o fuente de variación.</li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">myAnova</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span> <span class="op" style="color: #5E5E5E;">~</span> <span class="va" style="color: #111111;">class</span>, data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">data</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">myAnova</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
class         1   1074  1073.5   8.357 0.00393 **
Residuals   998 128198   128.5                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li>El resultado de la prueba muestra que existe evidencia estadísticamente significativa (<em>p=0.00393</em>) para considerar que la variación de la edad entre ambos grupos es diferente.</li>
</ul></section><section id="árboles-de-decisión" class="level1"><h1>Árboles de decisión</h1>
<center>
<img src="https://blogrpy.netlify.app/posts/tree_decision/www/img3.png">
</center>
<section id="generalidades" class="level2"><h2 class="anchored" data-anchor-id="generalidades">Generalidades</h2>
<center>
<img src="https://blogrpy.netlify.app/posts/tree_decision/www/img4.png">
</center>
<ul>
<li>Los árboles de decisión se pueden utilizar para problemas de regresión y clasificación.</li>
<li>Se pueden definir como una estructura jerárquica que busca particionar el espacio de características e identificar subconjuntos representativos. Desde la parte superior a inferior cada árbol tiene <em>nodo raíz</em>, <em>nodos de decisión o internos</em> y <em>nodos hojas o terminales</em>, los dos primeros se generan con base en reglas binarias. Mayor grado de pureza es la recompensa que busca el algoritmo al particionar el espacio inicial en subregiones, en ese orden de ideas el objetivo siempre será particionar los datos en nodos que sean lo más puros posible, sin embargo, matemáticamente es más fácil medir la <strong>impureza</strong> de una región específica, proporcionando una idea de qué tan heterogéneas son las clases en ese nodo; una métrica de uso común en problemas de clasificación para medir la impureza es el <strong>índice GINI</strong>, donde valores bajos indican mayor grado de pureza. Además del índice GINI también es posible utilizar otras métricas como la <strong>ganancia de información</strong> o la <strong>entropía</strong>.</li>
<li>
<strong>Ventajas:</strong>
<ul>
<li>Fácil de interpretar (sujeto a la profundidad).</li>
<li>No requieren estandarización o normalización de variables predictoras numéricas.</li>
<li>Permiten manipular variables categóricas sin necesidad de aplicar codificaciones tipo <em>one-hot</em> o <em>variables dummy</em>.</li>
<li>Requieren poco preprocesamiento de datos.</li>
<li>Permiten valores ausentes (<code>NA</code>).</li>
<li>Permite relaciones no lineales.</li>
</ul>
</li>
<li>
<strong>Desventajas:</strong>
<ul>
<li>Si no se controla adecuadamente la profundidad del árbol existe alta probabilidad de incurrir en <a href="https://es.wikipedia.org/wiki/Sobreajuste"><em>sobreajuste (overfitting)</em>.</a>
</li>
<li>Alta varianza, pequeños cambios en los datos pueden arrojar resultados muy diferentes.</li>
</ul>
</li>
<li>
<strong>Hiperparámetros:</strong> aunque ejecutar la función <code><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart()</a></code> con valores predeterminados puede ser una buena estrategia para iniciar, siempre estaremos interesados en ajustar determinados parámetros que nos permitan obtener mejor rendimiento predictivo. La función <code><a href="https://rdrr.io/pkg/rpart/man/rpart.control.html">rpart.control()</a></code> permite controlar manualmente otras opciones. Dentro los hiperparámetros más importantes en árboles de decisión están los siguientes:
<ul>
<li>Mínimo número de observaciones para generar una partición. En la biblioteca <code>rpart</code> lleva el nombre de <code>minsplit</code> y su valor por defecto es 20.</li>
<li>Máxima profundiad del árbol. En la biblioteca <code>rpart</code> lleva el nombre de <code>maxdepth</code> y su valor predeterminado es 30. Este parámetro es de alta relevancia para evitar el sobreajuste.</li>
<li>Parámetro de complejidad. En la biblioteca <code>rpart</code> lleva el nombre de <code>cp</code> y su valor por defecto es 0.01. Este parámetro sirve al propósito de penalizar y contolar el tamaño del árbol, valores bajos indican árboles de mayor complejidad, es decir, mayor número de divisiones. La función <code><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart()</a></code> internamente ejecuta <a href="https://es.wikipedia.org/wiki/Validaci%C3%B3n_cruzada">validación cruzada</a> 10 veces para estimar el valor óptimo de <strong>cp</strong>, es posible acceder a dicho resultado a través de la función <code><a href="https://rdrr.io/pkg/rpart/man/plotcp.html">plotcp()</a></code> que permitirá facilmente determinar el valor adecuado para este parámetro. Cuando se tiene el valor óptimo de <strong>cp</strong> será posible “podar” el árbol para que el modelo sea optimizado, dicho resultado es posible a través de la función <code><a href="https://rdrr.io/pkg/rpart/man/prune.rpart.html">prune()</a></code>.</li>
</ul>
</li>
</ul></section><section id="train---test" class="level2"><h2 class="anchored" data-anchor-id="train---test">Train - Test</h2>
<ul>
<li>Para entrenar el modelo inicialmente fracciono los datos en <em>train</em> y <em>test</em> con proporciones de 70 y 30%, respectivamente. Este proceso aunque es posible hacerlo manualmente con la función <code><a href="https://rdrr.io/r/base/sample.html">sample()</a></code>, la función <code><a href="https://rdrr.io/pkg/caret/man/createDataPartition.html">createDataPartition()</a></code> del paquete <code>caret</code> agiliza el procedimiento. Para garantizar replicabilidad en los resultados se agrega la semilla.</li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1992</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">idx</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/caret/man/createDataPartition.html">createDataPartition</a></span><span class="op" style="color: #5E5E5E;">(</span>y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">data</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">class</span>, times <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>, p <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.70</span>, list <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">FALSE</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">dataTrain</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">data</span><span class="op" style="color: #5E5E5E;">[</span><span class="va" style="color: #111111;">idx</span>, <span class="op" style="color: #5E5E5E;">]</span></span>
<span><span class="va" style="color: #111111;">dataTest</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">data</span><span class="op" style="color: #5E5E5E;">[</span><span class="op" style="color: #5E5E5E;">-</span><span class="va" style="color: #111111;">idx</span>, <span class="op" style="color: #5E5E5E;">]</span></span></code></pre></div>
</details>
</div>
</section><section id="rpart-default" class="level2"><h2 class="anchored" data-anchor-id="rpart-default">
<code>rpart</code> <em>default</em>
</h2>
<ul>
<li>
<strong>Ajuste del modelo:</strong> en este caso se utilizan todas las variables predictoras para entrenar el modelo. Al imprimir el objeto que contiene el modelo podemos observar el conjunto de reglas que dan como resultado la estructura final del árbol. El método igualado a <strong><code>method = "class"</code></strong> indica que es un problema de clasificación, si fuese un problema de regresión el argumento tomaría el valor de <strong><code>method = "anova"</code></strong>, aunque también permite otras opciones (consulte <code><a href="https://rdrr.io/pkg/rpart/man/rpart.html">?rpart</a></code> o <code><a href="https://rdrr.io/pkg/rpart/man/rpart.html">help("rpart")</a></code>).</li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">modArbol0</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">class</span> <span class="op" style="color: #5E5E5E;">~</span> <span class="va" style="color: #111111;">.</span>, data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">dataTrain</span>, method <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"class"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">modArbol0</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>n= 700 

node), split, n, loss, yval, (yprob)
      * denotes terminal node

  1) root 700 210 good (0.3000000 0.7000000)  
    2) checking_status=&lt;0,0&lt;=X&lt;200 385 168 good (0.4363636 0.5636364)  
      4) credit_history=all paid,no credits/all paid 51  14 bad (0.7254902 0.2745098)  
        8) savings_status=&lt;100,100&lt;=X&lt;500 42   8 bad (0.8095238 0.1904762) *
        9) savings_status=500&lt;=X&lt;1000,no known savings 9   3 good (0.3333333 0.6666667) *
      5) credit_history=critical/other existing credit,delayed previously,existing paid 334 131 good (0.3922156 0.6077844)  
       10) duration&gt;=27.5 77  30 bad (0.6103896 0.3896104)  
         20) purpose=domestic appliance,education,furniture/equipment,new car 39  10 bad (0.7435897 0.2564103) *
         21) purpose=business,other,radio/tv,repairs,used car 38  18 good (0.4736842 0.5263158)  
           42) checking_status=&lt;0 19   7 bad (0.6315789 0.3684211) *
           43) checking_status=0&lt;=X&lt;200 19   6 good (0.3157895 0.6842105) *
       11) duration&lt; 27.5 257  84 good (0.3268482 0.6731518)  
         22) purpose=domestic appliance,education,new car,retraining 83  41 good (0.4939759 0.5060241)  
           44) age&lt; 35.5 42  13 bad (0.6904762 0.3095238)  
             88) credit_amount&lt; 1392 20   1 bad (0.9500000 0.0500000) *
             89) credit_amount&gt;=1392 22  10 good (0.4545455 0.5454545)  
              178) property_magnitude=life insurance,real estate 13   4 bad (0.6923077 0.3076923) *
              179) property_magnitude=car,no known property 9   1 good (0.1111111 0.8888889) *
           45) age&gt;=35.5 41  12 good (0.2926829 0.7073171) *
         23) purpose=business,furniture/equipment,other,radio/tv,repairs,used car 174  43 good (0.2471264 0.7528736) *
    3) checking_status=&gt;=200,no checking 315  42 good (0.1333333 0.8666667) *</code></pre>
</div>
</div>
<ul>
<li>
<strong>Gráfico del modelo:</strong> la variable más importante y que da origen al nodo raíz es <strong><code>checking_status</code></strong>, que hace referencia al estado de la cuenta corriente. El historial crediticio, la duración del tiempo para pagar el crédito, el estado de la cuenta de ahorros y el propósito del crédito, también son factores determinantes. No tener suficiente capital en cualquiera de las dos cuentas, tener mal historial crediticio y además solicitar períodos de pago de alta duración, pueden ser características no deseables a la hora de solicitar un crédito.</li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/rpart.plot/man/rpart.plot.html">rpart.plot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">modArbol0</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/tree_decision/TreeD_R_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>
<strong>Matriz de confusión:</strong> el modelo por <em>default</em> tiene precisión promedio de 0.7167, con dificultades para clasificar de forma correcta los “malos”, es decir, que tiene baja especificidad.</li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">predichos_mod0</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;">(</span>object <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">modArbol0</span>, newdata <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">dataTest</span>, type <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"class"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/caret/man/confusionMatrix.html">confusionMatrix</a></span><span class="op" style="color: #5E5E5E;">(</span>data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">predichos_mod0</span>, reference <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">dataTest</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">class</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>                positive <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"good"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction bad good
      bad   31   26
      good  59  184
                                        
               Accuracy : 0.7167        
                 95% CI : (0.662, 0.767)
    No Information Rate : 0.7           
    P-Value [Acc &gt; NIR] : 0.2873596     
                                        
                  Kappa : 0.2465        
                                        
 Mcnemar's Test P-Value : 0.0005187     
                                        
            Sensitivity : 0.8762        
            Specificity : 0.3444        
         Pos Pred Value : 0.7572        
         Neg Pred Value : 0.5439        
             Prevalence : 0.7000        
         Detection Rate : 0.6133        
   Detection Prevalence : 0.8100        
      Balanced Accuracy : 0.6103        
                                        
       'Positive' Class : good          
                                        </code></pre>
</div>
</div>
<ul>
<li><strong>Área bajo la curva:</strong></li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># Probabilidades predichas para la clase "good"</span></span>
<span><span class="va" style="color: #111111;">pred0</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;">(</span>object <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">modArbol0</span>,</span>
<span>                               newdata <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">dataTest</span>, type <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"prob"</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">good</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Transformando respuesta a entero. A la clase "good" le agrego 1 y </span></span>
<span><span class="co" style="color: #5E5E5E;"># a la clase "bad" le agrego 0.</span></span>
<span><span class="va" style="color: #111111;">target</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">dataTest</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">class</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">-</span> <span class="fl" style="color: #AD0000;">1</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># AUC</span></span>
<span><span class="fu" style="color: #4758AB;">Metrics</span><span class="fu" style="color: #4758AB;">::</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/Metrics/man/auc.html">auc</a></span><span class="op" style="color: #5E5E5E;">(</span>actual <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">target</span>, predicted <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pred0</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7034392</code></pre>
</div>
</div>
<ul>
<li>
<strong>Curva ROC:</strong> la función con la que obtengo el siguiente gráfico puede ser encontrada en <a href="https://github.com/web-edimer/web-edimer.github.io/blob/master/_posts/TreeD_R/functions/myROC.R">mi Github.</a>
</li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># Cargando función</span>n</span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"functions/myROC.R"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Ver función myROC() al final en material complementario    </span> </span>
<span><span class="fu" style="color: #4758AB;">myROC</span><span class="op" style="color: #5E5E5E;">(</span>predichos <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pred0</span>, reales <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">target</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/tree_decision/TreeD_R_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Parámetro de complejidad (CP):</strong></li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/rpart/man/plotcp.html">plotcp</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">modArbol0</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/tree_decision/TreeD_R_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>
<strong>“Podando” el árbol:</strong> se elige el valor de cp = 0.025 por mostrar mejores resultados (bajo error).</li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">modArbol0_prune</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/rpart/man/prune.rpart.html">prune</a></span><span class="op" style="color: #5E5E5E;">(</span>tree <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">modArbol0</span>, cp <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.025</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">modArbol0_prune</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>n= 700 

node), split, n, loss, yval, (yprob)
      * denotes terminal node

 1) root 700 210 good (0.3000000 0.7000000)  
   2) checking_status=&lt;0,0&lt;=X&lt;200 385 168 good (0.4363636 0.5636364)  
     4) credit_history=all paid,no credits/all paid 51  14 bad (0.7254902 0.2745098) *
     5) credit_history=critical/other existing credit,delayed previously,existing paid 334 131 good (0.3922156 0.6077844)  
      10) duration&gt;=27.5 77  30 bad (0.6103896 0.3896104) *
      11) duration&lt; 27.5 257  84 good (0.3268482 0.6731518)  
        22) purpose=domestic appliance,education,new car,retraining 83  41 good (0.4939759 0.5060241)  
          44) age&lt; 35.5 42  13 bad (0.6904762 0.3095238) *
          45) age&gt;=35.5 41  12 good (0.2926829 0.7073171) *
        23) purpose=business,furniture/equipment,other,radio/tv,repairs,used car 174  43 good (0.2471264 0.7528736) *
   3) checking_status=&gt;=200,no checking 315  42 good (0.1333333 0.8666667) *</code></pre>
</div>
</div>
<ul>
<li><strong>Gráfico de árbol con “poda”:</strong></li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/rpart.plot/man/rpart.plot.html">rpart.plot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">modArbol0_prune</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/tree_decision/TreeD_R_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>
<strong>Matriz de confusión árbol con “poda”:</strong> respecto al árbol sin podar, la diferencia en precisión es muy pequeña (&lt;0.01), sin embargo, la especificidad se aumenta de 0.3444 a 0.4556 con la “poda”, aunque la sensitividad haya reducido de 0.8762 a 0.8381.</li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">predichos_mod0_prune</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;">(</span>object <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">modArbol0_prune</span>, newdata <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">dataTest</span>, type <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"class"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/caret/man/confusionMatrix.html">confusionMatrix</a></span><span class="op" style="color: #5E5E5E;">(</span>data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">predichos_mod0_prune</span>, reference <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">dataTest</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">class</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>                positive <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"good"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction bad good
      bad   41   34
      good  49  176
                                         
               Accuracy : 0.7233         
                 95% CI : (0.669, 0.7732)
    No Information Rate : 0.7            
    P-Value [Acc &gt; NIR] : 0.2072         
                                         
                  Kappa : 0.3083         
                                         
 Mcnemar's Test P-Value : 0.1244         
                                         
            Sensitivity : 0.8381         
            Specificity : 0.4556         
         Pos Pred Value : 0.7822         
         Neg Pred Value : 0.5467         
             Prevalence : 0.7000         
         Detection Rate : 0.5867         
   Detection Prevalence : 0.7500         
      Balanced Accuracy : 0.6468         
                                         
       'Positive' Class : good           
                                         </code></pre>
</div>
</div>
<ul>
<li><strong>Área bajo la curva de árbol con “poda”:</strong></li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># Probabilidades predichas para la clase "good"</span></span>
<span><span class="va" style="color: #111111;">pred0_prune</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;">(</span>object <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">modArbol0_prune</span>,</span>
<span>                                     newdata <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">dataTest</span>, type <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"prob"</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">good</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># AUC</span></span>
<span><span class="fu" style="color: #4758AB;">Metrics</span><span class="fu" style="color: #4758AB;">::</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/Metrics/man/auc.html">auc</a></span><span class="op" style="color: #5E5E5E;">(</span>actual <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">target</span>, predicted <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pred0_prune</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7203175</code></pre>
</div>
</div>
<ul>
<li><strong>Curva ROC:</strong></li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># Ver función myROC() al final en material complementario    </span> </span>
<span><span class="fu" style="color: #4758AB;">myROC</span><span class="op" style="color: #5E5E5E;">(</span>predichos <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pred0_prune</span>, reales <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">target</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/tree_decision/TreeD_R_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="tuning-con-caret" class="level2"><h2 class="anchored" data-anchor-id="tuning-con-caret">Tuning con caret</h2>
<ul>
<li>A diferencia de los parámetros que se “aprenden” duarante el entrenamiento del modelo, los hipeparámetros se definen previo al ajuste del mismo.</li>
<li>El ajuste de <a href="https://en.wikipedia.org/wiki/Hyperparameter_(machine_learning)">hiperparámetros</a> se constituye como parte fundamental de la optimización del modelo.</li>
<li>La biblioteca <a href="http://topepo.github.io/caret/index.html"><code>caret</code></a> proporciona un marco de trabajo unificado para entrenar y validar modelos de machine learning. En este caso, con <code>caret</code> podremos ajustar dos de los tres hiperparámetros mencionados anteriormente, el parámetro de complejidad y la profundidad del árbol. Las funciones <strong><code><a href="https://rdrr.io/pkg/caret/man/trainControl.html">trainControl()</a></code></strong> y <strong><code>train</code></strong> de la biblioteca <code>caret</code> facilitan el proceso.
<ul>
<li>
<strong><code><a href="https://rdrr.io/pkg/caret/man/trainControl.html">trainControl()</a></code>:</strong> permite establecer la estrategia de validación, por ejemplo validación cruzada <em>k-fold</em>, validación cruzada repetida, bootstrapping, entre otras. Desde esta misma función también es posible determinar el método de búsqueda de hiperparámetros, que puede ser <em>aleatoria</em> o <em>cuadrícula (grid)</em>. En este caso particular utilizo <em>validación cruzada con repeticiones</em>, con k = 5 y 3 repeticiones. El argumento <code>summaryFunction = twoClassSummary</code> permite computar las métricas necesarias (sensitividad y especificidad) para obtener ROC. Busque más ayuda con <code><a href="https://rdrr.io/pkg/caret/man/trainControl.html">help("trainControl")</a></code>.</li>
<li>
<strong><code><a href="https://rdrr.io/pkg/caret/man/train.html">train()</a></code>:</strong> ajuste el modelo estableciendo la fórmula habitual en R, el método o algoritmo para entrenar, (<a href="http://topepo.github.io/caret/available-models.html">lista de algoritmos en <code>caret</code></a>) los datos, la configuración para el entrenamiento (<code>tcConrol = myControl</code>) y la longitud de hiperparámetros a considerar en el entrenamiento (<code>tuneLenth</code>). Este último argumento dependerá de los hiperparámetros que estén disponibles en <code>caret</code>, aunque también es posible asignarlos manualmente a través de <code><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid()</a></code>. Utilizar el método igualado a “rpart” permitirá optimizar el parámetro <em>cp</em> y utilizando “rpart2” es posible optimizar la máxima profundidad del árbol. Cuando se declara <code>tuneLength = 5</code> se informa que el número máximo de profundidades a probar será 5, es decir, que al final existirán 5 resultados diferentes con el mismo algoritmo. Por último, se agrega la métrica que será utilizada para comparar los resultados de la validación cruzada.</li>
</ul>
</li>
<li>
<strong>Nota:</strong> como el procedimiento de validación cruzada implica muestreo aleatorio, es necesario asignar la semilla para garantizar replicabilidad de resultados.</li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">myControl</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/caret/man/trainControl.html">trainControl</a></span><span class="op" style="color: #5E5E5E;">(</span>method <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"repeatedcv"</span>,</span>
<span>                          number <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">5</span>,</span>
<span>                          repeats <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">3</span>,</span>
<span>                          classProbs <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">TRUE</span>,  <span class="co" style="color: #5E5E5E;"># Permite predecir probabilidades</span></span>
<span>                          summaryFunction <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">twoClassSummary</span><span class="op" style="color: #5E5E5E;">)</span> </span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1992</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">modArbol_tune</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">class</span> <span class="op" style="color: #5E5E5E;">~</span> <span class="va" style="color: #111111;">.</span>,</span>
<span>                       method <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"rpart2"</span>,</span>
<span>                       data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">data</span>,</span>
<span>                       trControl <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">myControl</span>,</span>
<span>                       tuneLength <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">5</span>,</span>
<span>                       metric <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"ROC"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">modArbol_tune</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>CART 

1000 samples
  20 predictor
   2 classes: 'bad', 'good' 

No pre-processing
Resampling: Cross-Validated (5 fold, repeated 3 times) 
Summary of sample sizes: 800, 800, 800, 800, 800, 800, ... 
Resampling results across tuning parameters:

  maxdepth  ROC        Sens       Spec     
   3        0.7028968  0.3011111  0.8885714
   6        0.7138095  0.3244444  0.8880952
  11        0.7211151  0.3988889  0.8642857
  14        0.7213571  0.4055556  0.8623810
  18        0.7211746  0.3911111  0.8671429

ROC was used to select the optimal model using the largest value.
The final value used for the model was maxdepth = 14.</code></pre>
</div>
</div>
<ul>
<li>Se observa que la mejor profundidad es 14 con la mayor sensitividad aún cuando no tiene la mejor especificidad. A continuación la matriz de confusión en el conjunto de test muestra mejoras en la capacidad de detectar los clasificados como “malos”, ademas la precisión es notablemente superior.</li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">predichos_tune</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;">(</span>object <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">modArbol_tune</span>, newdata <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">dataTest</span>, type <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"raw"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/caret/man/confusionMatrix.html">confusionMatrix</a></span><span class="op" style="color: #5E5E5E;">(</span>data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">predichos_tune</span>, reference <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">dataTest</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">class</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>                positive <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"good"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction bad good
      bad   52   29
      good  38  181
                                          
               Accuracy : 0.7767          
                 95% CI : (0.7253, 0.8225)
    No Information Rate : 0.7             
    P-Value [Acc &gt; NIR] : 0.001839        
                                          
                  Kappa : 0.4526          
                                          
 Mcnemar's Test P-Value : 0.328393        
                                          
            Sensitivity : 0.8619          
            Specificity : 0.5778          
         Pos Pred Value : 0.8265          
         Neg Pred Value : 0.6420          
             Prevalence : 0.7000          
         Detection Rate : 0.6033          
   Detection Prevalence : 0.7300          
      Balanced Accuracy : 0.7198          
                                          
       'Positive' Class : good            
                                          </code></pre>
</div>
</div>
<ul>
<li>
<strong>Área bajo la curva</strong> el modelo evidentemente consigue mejores resultados respecto a los ajustados inicialmente, de tal manera que el ajuste de hiperparámetros ha logrado mejorar nuestras predicciones en datos que el modelo aún no ha visto. Posiblemente el hecho de ajustar la máxima profundidad sumado al uso de validación cruzada, permite que el modelo capture de mejor manera las relaciones subyacentes entre características.</li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb32" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># Probabilidades predichas para la clase "good"</span></span>
<span><span class="va" style="color: #111111;">pred_tune</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;">(</span>object <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">modArbol_tune</span>,</span>
<span>                                   newdata <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">dataTest</span>, type <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"prob"</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">good</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># AUC</span></span>
<span><span class="fu" style="color: #4758AB;">Metrics</span><span class="fu" style="color: #4758AB;">::</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/Metrics/man/auc.html">auc</a></span><span class="op" style="color: #5E5E5E;">(</span>actual <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">target</span>, predicted <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pred_tune</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7888624</code></pre>
</div>
</div>
<ul>
<li><strong>Curva ROC:</strong></li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb34" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># Ver función myROC() al final en material complementario    </span> </span>
<span><span class="fu" style="color: #4758AB;">myROC</span><span class="op" style="color: #5E5E5E;">(</span>predichos <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pred_tune</span>, reales <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">target</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/tree_decision/TreeD_R_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="complementario" class="level1"><h1>Complementario</h1>
<section id="función-plot-caret" class="level2"><h2 class="anchored" data-anchor-id="función-plot-caret">Función <code>plot</code> + <code>caret</code>
</h2>
<ul>
<li>La función <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> tiene un método específico para resultados obtenidos a través de <code>caret</code>, en este caso muestra el gráfico del hiperparámetro de interés, la máxima profundidad del árbol vs la curva ROC en el eje Y, tratando de evidenicar el valor óptimo.</li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb35" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">modArbol_tune</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/tree_decision/TreeD_R_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="gráfico-interactivo-con-visnetwork" class="level2"><h2 class="anchored" data-anchor-id="gráfico-interactivo-con-visnetwork">Gráfico interactivo con <code>visNetwork</code>
</h2>
<ul>
<li>La biblioteca <a href="https://datastorm-open.github.io/visNetwork/"><code>visNetwork</code></a> permite crear gráficos interactivos para objetos de la clase <em>rpart</em>. A manera de ejemplo se presenta el gráfico para el árbol de decisión con poda. Recuerde que es interactivo y puede manipularlo con el <em>mouse</em>.</li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb36" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="http://datastorm-open.github.io/visNetwork/">visNetwork</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/visNetwork/man/visTree.html">visTree</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">modArbol0_prune</span>, </span>
<span>        main <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Árbol con poda"</span>", width<span class="op" style="color: #5E5E5E;">=</span>=<span class="st" style="color: #20794D;">"100%"</span>",</span>
<span>        height <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"800px"</span>,  edgesFontSize <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">14</span>, nodesFontSize <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">16</span>,<span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div id="htmlwidget-4b2849920125f3c0d1eb" style="width:100%;height:800px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-4b2849920125f3c0d1eb">{"x":{"nodes":{"id":[1,2,4,5,10,11,22,44,45,23,3],"label":["checking_status","credit_history","bad","duration","bad","purpose","age","bad","good","good","good"],"level":[1,2,3,3,4,4,5,6,6,5,2],"color":["#F1B8C2","#DAC49C","#7D91B6","#A9D1A5","#7D91B6","#8AD3D0","#B4C7ED","#7D91B6","#B9828C","#B9828C","#B9828C"],"value":[700,385,51,334,77,257,83,42,41,174,315],"shape":["dot","dot","square","dot","square","dot","dot","square","square","square","square"],"title":["<div style=\"text-align:center;\">N : <b>100%<\/b> (700)<br>Complexity : <b>0.055<\/b><br>bad : <b>30%<\/b> (210)<br>good : <b>70%<\/b> (490)<\/div>","<div style=\"text-align:center;\">N : <b>55%<\/b> (385)<br>Complexity : <b>0.055<\/b><br>bad : <b>43.6%<\/b> (168)<br>good : <b>56.4%<\/b> (217)<hr class = \"rPartvisNetwork\">\n<div class =\"showOnMe2\"><div style=\"text-align:center;\"><U style=\"color:blue;\"  onmouseover=\"this.style.cursor='pointer';\" onmouseout=\"this.style.cursor='default';\">Rules<\/U><\/div>\n<div class=\"showMeRpartTTp2\" style=\"display:none;\">\n<b> checking_status <\/b> <0, 0<=X<200<\/script><script type=\"text/javascript\">$(document).ready(function(){\n$(\".showOnMe2\").click(function(){\n$(\".showMeRpartTTp2\").toggle();\n$.sparkline_display_visible();\n});\n  });<\/script><\/div><\/div>\n\n<\/div>","<div style=\"text-align:center;\">N : <b>7.3%<\/b> (51)<br>Complexity : <b>0.014<\/b><br>bad : <b>72.5%<\/b> (37)<br>good : <b>27.5%<\/b> (14)<hr class = \"rPartvisNetwork\">\n<div class =\"showOnMe2\"><div style=\"text-align:center;\"><U style=\"color:blue;\"  onmouseover=\"this.style.cursor='pointer';\" onmouseout=\"this.style.cursor='default';\">Rules<\/U><\/div>\n<div class=\"showMeRpartTTp2\" style=\"display:none;\">\n<b> checking_status <\/b> <0, 0<=X<200<br><b> credit_history <\/b> all paid, no credits/all paid<\/script><script type=\"text/javascript\">$(document).ready(function(){\n$(\".showOnMe2\").click(function(){\n$(\".showMeRpartTTp2\").toggle();\n$.sparkline_display_visible();\n});\n  });<\/script><\/div><\/div>\n\n<\/div>","<div style=\"text-align:center;\">N : <b>47.7%<\/b> (334)<br>Complexity : <b>0.055<\/b><br>bad : <b>39.2%<\/b> (131)<br>good : <b>60.8%<\/b> (203)<hr class = \"rPartvisNetwork\">\n<div class =\"showOnMe2\"><div style=\"text-align:center;\"><U style=\"color:blue;\"  onmouseover=\"this.style.cursor='pointer';\" onmouseout=\"this.style.cursor='default';\">Rules<\/U><\/div>\n<div class=\"showMeRpartTTp2\" style=\"display:none;\">\n<b> checking_status <\/b> <0, 0<=X<200<br><b> credit_history <\/b> critical/other existing credit, delayed previously, existing paid<\/script><script type=\"text/javascript\">$(document).ready(function(){\n$(\".showOnMe2\").click(function(){\n$(\".showMeRpartTTp2\").toggle();\n$.sparkline_display_visible();\n});\n  });<\/script><\/div><\/div>\n\n<\/div>","<div style=\"text-align:center;\">N : <b>11%<\/b> (77)<br>Complexity : <b>0.017<\/b><br>bad : <b>61%<\/b> (47)<br>good : <b>39%<\/b> (30)<hr class = \"rPartvisNetwork\">\n<div class =\"showOnMe2\"><div style=\"text-align:center;\"><U style=\"color:blue;\"  onmouseover=\"this.style.cursor='pointer';\" onmouseout=\"this.style.cursor='default';\">Rules<\/U><\/div>\n<div class=\"showMeRpartTTp2\" style=\"display:none;\">\n<b> checking_status <\/b> <0, 0<=X<200<br><b> credit_history <\/b> critical/other existing credit, delayed previously, existing paid<br><b> duration <\/b> >= 27.5<\/script><script type=\"text/javascript\">$(document).ready(function(){\n$(\".showOnMe2\").click(function(){\n$(\".showMeRpartTTp2\").toggle();\n$.sparkline_display_visible();\n});\n  });<\/script><\/div><\/div>\n\n<\/div>","<div style=\"text-align:center;\">N : <b>36.7%<\/b> (257)<br>Complexity : <b>0.038<\/b><br>bad : <b>32.7%<\/b> (84)<br>good : <b>67.3%<\/b> (173)<hr class = \"rPartvisNetwork\">\n<div class =\"showOnMe2\"><div style=\"text-align:center;\"><U style=\"color:blue;\"  onmouseover=\"this.style.cursor='pointer';\" onmouseout=\"this.style.cursor='default';\">Rules<\/U><\/div>\n<div class=\"showMeRpartTTp2\" style=\"display:none;\">\n<b> checking_status <\/b> <0, 0<=X<200<br><b> credit_history <\/b> critical/other existing credit, delayed previously, existing paid<br><b> duration <\/b> < 27.5<\/script><script type=\"text/javascript\">$(document).ready(function(){\n$(\".showOnMe2\").click(function(){\n$(\".showMeRpartTTp2\").toggle();\n$.sparkline_display_visible();\n});\n  });<\/script><\/div><\/div>\n\n<\/div>","<div style=\"text-align:center;\">N : <b>11.9%<\/b> (83)<br>Complexity : <b>0.038<\/b><br>bad : <b>49.4%<\/b> (41)<br>good : <b>50.6%<\/b> (42)<hr class = \"rPartvisNetwork\">\n<div class =\"showOnMe2\"><div style=\"text-align:center;\"><U style=\"color:blue;\"  onmouseover=\"this.style.cursor='pointer';\" onmouseout=\"this.style.cursor='default';\">Rules<\/U><\/div>\n<div class=\"showMeRpartTTp2\" style=\"display:none;\">\n<b> checking_status <\/b> <0, 0<=X<200<br><b> credit_history <\/b> critical/other existing credit, delayed previously, existing paid<br><b> duration <\/b> < 27.5<br><b> purpose <\/b> domestic appliance, education, new car, retraining<\/script><script type=\"text/javascript\">$(document).ready(function(){\n$(\".showOnMe2\").click(function(){\n$(\".showMeRpartTTp2\").toggle();\n$.sparkline_display_visible();\n});\n  });<\/script><\/div><\/div>\n\n<\/div>","<div style=\"text-align:center;\">N : <b>6%<\/b> (42)<br>Complexity : <b>0.017<\/b><br>bad : <b>69%<\/b> (29)<br>good : <b>31%<\/b> (13)<hr class = \"rPartvisNetwork\">\n<div class =\"showOnMe2\"><div style=\"text-align:center;\"><U style=\"color:blue;\"  onmouseover=\"this.style.cursor='pointer';\" onmouseout=\"this.style.cursor='default';\">Rules<\/U><\/div>\n<div class=\"showMeRpartTTp2\" style=\"display:none;\">\n<b> checking_status <\/b> <0, 0<=X<200<br><b> credit_history <\/b> critical/other existing credit, delayed previously, existing paid<br><b> duration <\/b> < 27.5<br><b> purpose <\/b> domestic appliance, education, new car, retraining<br><b> age <\/b> < 35.5<\/script><script type=\"text/javascript\">$(document).ready(function(){\n$(\".showOnMe2\").click(function(){\n$(\".showMeRpartTTp2\").toggle();\n$.sparkline_display_visible();\n});\n  });<\/script><\/div><\/div>\n\n<\/div>","<div style=\"text-align:center;\">N : <b>5.9%<\/b> (41)<br>Complexity : <b>0.01<\/b><br>bad : <b>29.3%<\/b> (12)<br>good : <b>70.7%<\/b> (29)<hr class = \"rPartvisNetwork\">\n<div class =\"showOnMe2\"><div style=\"text-align:center;\"><U style=\"color:blue;\"  onmouseover=\"this.style.cursor='pointer';\" onmouseout=\"this.style.cursor='default';\">Rules<\/U><\/div>\n<div class=\"showMeRpartTTp2\" style=\"display:none;\">\n<b> checking_status <\/b> <0, 0<=X<200<br><b> credit_history <\/b> critical/other existing credit, delayed previously, existing paid<br><b> duration <\/b> < 27.5<br><b> purpose <\/b> domestic appliance, education, new car, retraining<br><b> age <\/b> >= 35.5<\/script><script type=\"text/javascript\">$(document).ready(function(){\n$(\".showOnMe2\").click(function(){\n$(\".showMeRpartTTp2\").toggle();\n$.sparkline_display_visible();\n});\n  });<\/script><\/div><\/div>\n\n<\/div>","<div style=\"text-align:center;\">N : <b>24.9%<\/b> (174)<br>Complexity : <b>0.01<\/b><br>bad : <b>24.7%<\/b> (43)<br>good : <b>75.3%<\/b> (131)<hr class = \"rPartvisNetwork\">\n<div class =\"showOnMe2\"><div style=\"text-align:center;\"><U style=\"color:blue;\"  onmouseover=\"this.style.cursor='pointer';\" onmouseout=\"this.style.cursor='default';\">Rules<\/U><\/div>\n<div class=\"showMeRpartTTp2\" style=\"display:none;\">\n<b> checking_status <\/b> <0, 0<=X<200<br><b> credit_history <\/b> critical/other existing credit, delayed previously, existing paid<br><b> duration <\/b> < 27.5<br><b> purpose <\/b> business, furniture/equipment, other, radio/tv, repairs, used car<\/script><script type=\"text/javascript\">$(document).ready(function(){\n$(\".showOnMe2\").click(function(){\n$(\".showMeRpartTTp2\").toggle();\n$.sparkline_display_visible();\n});\n  });<\/script><\/div><\/div>\n\n<\/div>","<div style=\"text-align:center;\">N : <b>45%<\/b> (315)<br>Complexity : <b>0.01<\/b><br>bad : <b>13.3%<\/b> (42)<br>good : <b>86.7%<\/b> (273)<hr class = \"rPartvisNetwork\">\n<div class =\"showOnMe2\"><div style=\"text-align:center;\"><U style=\"color:blue;\"  onmouseover=\"this.style.cursor='pointer';\" onmouseout=\"this.style.cursor='default';\">Rules<\/U><\/div>\n<div class=\"showMeRpartTTp2\" style=\"display:none;\">\n<b> checking_status <\/b> >=200, no checking<\/script><script type=\"text/javascript\">$(document).ready(function(){\n$(\".showOnMe2\").click(function(){\n$(\".showMeRpartTTp2\").toggle();\n$.sparkline_display_visible();\n});\n  });<\/script><\/div><\/div>\n\n<\/div>"],"fixed":[true,true,true,true,true,true,true,true,true,true,true],"colorClust":["#B9828C","#B9828C","#7D91B6","#B9828C","#7D91B6","#B9828C","#B9828C","#7D91B6","#B9828C","#B9828C","#B9828C"],"labelClust":["good","good","bad","good","bad","good","good","bad","good","good","good"],"Leaf":[0,0,1,0,1,0,0,1,1,1,1],"font.size":[16,16,16,16,16,16,16,16,16,16,16],"scaling.min":[22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5],"scaling.max":[22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5]},"edges":{"id":["edge1","edge2","edge3","edge4","edge5","edge6","edge7","edge8","edge9","edge10"],"from":[1,2,2,5,5,11,22,22,11,1],"to":[2,4,5,10,11,22,44,45,23,3],"label":["<0, 0<=...","all pai...","critica...",">= 27.5","< 27.5","domesti...","< 35.5",">= 35.5","busines...",">=200, ..."],"value":[385,51,334,77,257,83,42,41,174,315],"title":["<div style=\"text-align:center;\"><b>checking_status<\/b><\/div><div style=\"text-align:center;\"><0<\/div><div style=\"text-align:center;\">0<=X<200<\/div>","<div style=\"text-align:center;\"><b>credit_history<\/b><\/div><div style=\"text-align:center;\">all paid<\/div><div style=\"text-align:center;\">no credits/all paid<\/div>","<div style=\"text-align:center;\"><b>credit_history<\/b><\/div><div style=\"text-align:center;\">critical/other existing credit<\/div><div style=\"text-align:center;\">delayed previously<\/div><div style=\"text-align:center;\">existing paid<\/div>","<div style=\"text-align:center;\"><b>duration<\/b><\/div><div style=\"text-align:center;\">>=27.5<\/div>","<div style=\"text-align:center;\"><b>duration<\/b><\/div><div style=\"text-align:center;\"><27.5<\/div>","<div style=\"text-align:center;\"><b>purpose<\/b><\/div><div style=\"text-align:center;\">domestic appliance<\/div><div style=\"text-align:center;\">education<\/div><div style=\"text-align:center;\">new car<\/div><div style=\"text-align:center;\">retraining<\/div>","<div style=\"text-align:center;\"><b>age<\/b><\/div><div style=\"text-align:center;\"><35.5<\/div>","<div style=\"text-align:center;\"><b>age<\/b><\/div><div style=\"text-align:center;\">>=35.5<\/div>","<div style=\"text-align:center;\"><b>purpose<\/b><\/div><div style=\"text-align:center;\">business<\/div><div style=\"text-align:center;\">furniture/equipment<\/div><div style=\"text-align:center;\">other<\/div><div style=\"text-align:center;\">radio/tv<\/div><div style=\"text-align:center;\">repairs<\/div><div style=\"text-align:center;\">used car<\/div>","<div style=\"text-align:center;\"><b>checking_status<\/b><\/div><div style=\"text-align:center;\">>=200<\/div><div style=\"text-align:center;\">no checking<\/div>"],"color":["#8181F7","#8181F7","#8181F7","#8181F7","#8181F7","#8181F7","#8181F7","#8181F7","#8181F7","#8181F7"],"font.size":[14,14,14,14,14,14,14,14,14,14],"font.align":["horizontal","horizontal","horizontal","horizontal","horizontal","horizontal","horizontal","horizontal","horizontal","horizontal"],"smooth.enabled":[true,true,true,true,true,true,true,true,true,true],"smooth.type":["cubicBezier","cubicBezier","cubicBezier","cubicBezier","cubicBezier","cubicBezier","cubicBezier","cubicBezier","cubicBezier","cubicBezier"],"smooth.roundness":[0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"layout":{"hierarchical":{"enabled":true,"direction":"UD"}},"interaction":{"dragNodes":false,"selectConnectedEdges":false,"tooltipDelay":500,"zoomSpeed":1},"edges":{"scaling":{"label":{"enabled":false}}}},"groups":null,"width":"100%","height":"800px","idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"Árbol con poda","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":{"text":"","style":"font-family:Georgia, Times New Roman, Times, serif;font-size:12px;text-align:center;"},"footer":{"text":"","style":"font-family:Georgia, Times New Roman, Times, serif;font-size:12px;text-align:center;"},"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":{"from":50000,"to":0},"algorithm":"hierarchical","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":true,"fit":true,"resetHighlight":true,"clusterOptions":{"fixed":true,"physics":false},"keepCoord":true,"labelSuffix":"(cluster)"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;\n                      white-space: nowrap;\n                      font-family: cursive;font-size:12px;font-color:purple;background-color: #E6E6E6;\n                      border-radius: 15px;","OnceEvents":{"stabilized":"function() { \n        this.setOptions({layout:{hierarchical:false}, physics:{solver:'barnesHut', enabled:true, stabilization : false}, nodes : {physics : false, fixed : true}});\n    }"},"legend":{"width":0.1,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":{"label":["age","checking_status","credit_history","duration","purpose","bad","good"],"color":["#B4C7ED","#F1B8C2","#DAC49C","#A9D1A5","#8AD3D0","#7D91B6","#B9828C"],"shape":["dot","dot","dot","dot","dot","square","square"],"size":[22,22,22,22,22,22,22],"Leaf":[0,0,0,0,0,1,1],"font.size":[16,16,16,16,16,16,16],"id":[10000,10001,10002,10003,10004,10005,10006]},"nodesToDataframe":true},"tree":{"updateShape":true,"shapeVar":"dot","shapeY":"square","colorVar":{"variable":["checking_status","credit_history","duration","purpose","age"],"color":["#F1B8C2","#DAC49C","#A9D1A5","#8AD3D0","#B4C7ED"]},"colorY":{"colorY":{"modality":["bad","good"],"color":["#7D91B6","#B9828C"]},"vardecidedClust":["good","good","bad","good","bad","good","good","bad","good","good","good"]}},"export":{"type":"png","css":"float:right;-webkit-border-radius: 10;\n                  -moz-border-radius: 10;\n                  border-radius: 10px;\n                  font-family: Arial;\n                  color: #ffffff;\n                  font-size: 12px;\n                  background: #090a0a;\n                  padding: 4px 8px 4px 4px;\n                  text-decoration: none;","background":"#fff","name":"network.png","label":"Export as png"}},"evals":["OnceEvents.stabilized"],"jsHooks":[]}</script>
</div>
</div>
</section><section id="función-myroc" class="level2"><h2 class="anchored" data-anchor-id="función-myroc">Función <code>myROC()</code>
</h2>
<ul>
<li>Es necesario tener cargadas las bibliotecaS <code>dplyr</code>, <code>ggplot2</code>, <code>hrbrthemes</code>, <code>Metrics</code> y <code>pROC</code> para ejecutar la función.</li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb37" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">myROC</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="kw" style="color: #003B4F;">function</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">predichos</span>, <span class="va" style="color: #111111;">reales</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">{</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="http://expasy.org/tools/pROC/">pROC</a></span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://github.com/mfrasco/Metrics">Metrics</a></span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span>  <span class="va" style="color: #111111;">x</span> <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">reales</span>, <span class="va" style="color: #111111;">predichos</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span>  <span class="va" style="color: #111111;">df</span> <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://tibble.tidyverse.org/reference/deprecated.html">data_frame</a></span><span class="op" style="color: #5E5E5E;">(</span>TPR <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">x</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">sensitivities</span>,</span>
<span>                  FPR <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span> <span class="op" style="color: #5E5E5E;">-</span> <span class="va" style="color: #111111;">x</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">specificities</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span>  <span class="va" style="color: #111111;">gg</span> <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">df</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">FPR</span>, ymin <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0</span>, ymax <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">TPR</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">TPR</span><span class="op" style="color: #5E5E5E;">)</span>, fill <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"#5A5156"</span>, alpha <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.7</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">TPR</span><span class="op" style="color: #5E5E5E;">)</span>, col <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"#F6222E"</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1.3</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>      intercept <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0</span>,</span>
<span>      slope <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>,</span>
<span>      color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"gray37"</span>,</span>
<span>      size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>,</span>
<span>      linetype <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"dashed"</span></span>
<span>    <span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/hrbrthemes/man/theme_ipsum.html">theme_ipsum</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_equal</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>      x <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"FPR (1 - Especificidad)"</span>,</span>
<span>      y <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"TPR (Sensitividad)"</span>,</span>
<span>      title <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"Curva ROC"</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>      subtitle <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>        <span class="st" style="color: #20794D;">"Valor AUC: "</span>,</span>
<span>        <span class="fu" style="color: #4758AB;">Metrics</span><span class="fu" style="color: #4758AB;">::</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/Metrics/man/auc.html">auc</a></span><span class="op" style="color: #5E5E5E;">(</span>actual <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">reales</span>,</span>
<span>                     predicted <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">predichos</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">4</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span>      <span class="op" style="color: #5E5E5E;">)</span></span>
<span>    <span class="op" style="color: #5E5E5E;">)</span></span>
<span>  <span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">gg</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="op" style="color: #5E5E5E;">}</span></span></code></pre></div>
</details>
</div>
</section></section><section id="recursos-de-información" class="level1"><h1>Recursos de información</h1>
<ul>
<li><a href="http://faculty.marshall.usc.edu/gareth-james/ISL/">An Introduction to Statistical Learning with Applications in R.</a></li>
<li><a href="https://www.statmethods.net/advstats/cart.html">Tree-Based Models.</a></li>
<li><a href="https://rpubs.com/Joaquin_AR/255596">Árboles de predicción - Joaquín A. Rodrigo.</a></li>
<li><a href="https://www.datacamp.com/courses/machine-learning-with-tree-based-models-in-r">Curso DataCamp - <em>Tree-Based Models in R</em>.</a></li>
</ul>


<!-- -->

</section> ]]></description>
  <category>R</category>
  <category>Tree Decision</category>
  <category>ML</category>
  <guid>https://blogrpy.netlify.app/posts/tree_decision/TreeD_R.html</guid>
  <pubDate>Sat, 18 Jul 2020 05:00:00 GMT</pubDate>
  <media:content url="https://blogrpy.netlify.app/posts/tree_decision/img1.png " medium="image"/>
</item>
<item>
  <title>Algoritmos de ML con caret en R (1)</title>
  <dc:creator>Edimer (Sidereus)</dc:creator>
  <link>https://blogrpy.netlify.app/posts/caret_r/caret_R.html</link>
  <description><![CDATA[ <section id="datos" class="level1"><h1>Datos</h1>
<ul>
<li><a href="https://www.kaggle.com/pavanraj159/predicting-a-pulsar-star#pulsar_stars.csv">Fuente: predicción de estrellas púlsar.</a></li>
<li><a href="https://es.wikipedia.org/wiki/P%C3%BAlsar">¿Qué es un púlsar?</a></li>
</ul></section><section id="problema" class="level1"><h1>Problema</h1>
<ul>
<li>
<strong>Descripción:</strong> a través de emisiones de radio detectables en nuestro planeta, los científicos perfilan los púlsares en función de múltiples métricas provenientes del análisis de señales; el ruido causado por interferencia de radiofrecuencia dificulta la labor de los investigadores. Se propone generar un sistema automático que proporcione alta precisión para detectar estrellas <strong>púlsar</strong>. (<a href="https://archive.ics.uci.edu/ml/datasets/HTRU2">ver más información</a>)</li>
<li>
<strong>Tipo de aprendizaje:</strong> Aprendizaje Supervisado - Clasificación Binaria.</li>
<li>Algoritmos:
<ul>
<li><a href="https://es.wikipedia.org/wiki/Random_forest">Random Forest</a></li>
<li><a href="https://es.wikipedia.org/wiki/M%C3%A1quinas_de_vectores_de_soporte">Support Vector Machine-SVM</a></li>
</ul>
</li>
</ul></section><section id="importando-datos" class="level1"><h1>Importando datos</h1>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># Cargando biblioteca data.table</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://r-datatable.com">data.table</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Nombres de variables</span></span>
<span><span class="va" style="color: #111111;">nombres</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"media_pefil"</span>, <span class="st" style="color: #20794D;">"de_perfil"</span>, <span class="st" style="color: #20794D;">"curtosis_perfil"</span>, <span class="st" style="color: #20794D;">"asimet_perfil"</span>, <span class="st" style="color: #20794D;">"media_dmsnr"</span>,</span>
<span>             <span class="st" style="color: #20794D;">"de_dmsnr"</span>, <span class="st" style="color: #20794D;">"curtosis_dmsnr"</span>, <span class="st" style="color: #20794D;">"asimet_dmsnr"</span>, <span class="st" style="color: #20794D;">"pulsar"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;">df_pulsar</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html">fread</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"data/pulsar_stars.csv"</span>, sep <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">","</span>, col.names <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">nombres</span>,</span>
<span>                   colClasses <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"numeric"</span>, <span class="fl" style="color: #AD0000;">8</span><span class="op" style="color: #5E5E5E;">)</span>, <span class="st" style="color: #20794D;">"factor"</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">df_pulsar</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["media_pefil"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["de_perfil"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["curtosis_perfil"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["asimet_perfil"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["media_dmsnr"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["de_dmsnr"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["curtosis_dmsnr"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["asimet_dmsnr"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["pulsar"],"name":[9],"type":["fct"],"align":["left"]}],"data":[{"1":"140.56250","2":"55.68378","3":"-0.23457141","4":"-0.6996484","5":"3.199833","6":"19.11043","7":"7.975532","8":"74.24222","9":"0"},{"1":"102.50781","2":"58.88243","3":"0.46531815","4":"-0.5150879","5":"1.677258","6":"14.86015","7":"10.576487","8":"127.39358","9":"0"},{"1":"103.01562","2":"39.34165","3":"0.32332837","4":"1.0511644","5":"3.121237","6":"21.74467","7":"7.735822","8":"63.17191","9":"0"},{"1":"136.75000","2":"57.17845","3":"-0.06841464","4":"-0.6362384","5":"3.642977","6":"20.95928","7":"6.896499","8":"53.59366","9":"0"},{"1":"88.72656","2":"40.67223","3":"0.60086608","4":"1.1234917","5":"1.178930","6":"11.46872","7":"14.269573","8":"252.56731","9":"0"},{"1":"93.57031","2":"46.69811","3":"0.53190485","4":"0.4167211","5":"1.636288","6":"14.54507","7":"10.621748","8":"131.39400","9":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="exploración" class="level1"><h1>Exploración</h1>
<ul>
<li><strong>Definiento tema de <code>ggplot2</code> para gráficos:</strong></li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># Cargando biblioteca tidyverse</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Tema personalizado para gráficos</span>s</span>
<span><span class="va" style="color: #111111;">mi_temagg</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op" style="color: #5E5E5E;">(</span>axis.text.x <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op" style="color: #5E5E5E;">(</span>color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"black"</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>        axis.text.y <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op" style="color: #5E5E5E;">(</span>color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"black"</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>        strip.background <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op" style="color: #5E5E5E;">(</span>fill <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"gray5"</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>        strip.text <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op" style="color: #5E5E5E;">(</span>color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"white"</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">12</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details>
</div>
<section id="variable-respuesta" class="level2"><h2 class="anchored" data-anchor-id="variable-respuesta">Variable respuesta</h2>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">df_pulsar</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">pulsar</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span>data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">.</span>, <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pulsar</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">n</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op" style="color: #5E5E5E;">(</span>color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"black"</span>, fill <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"#033660"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_label</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>label <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">n</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"¿Púlsar?"</span>?", titl<span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Distribución de variable respuesta"</span>ta",</span>
<span>       subtitle <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"0=No\n1=Sí"</span><span class="op" style="color: #5E5E5E;">)</span>)<span class="op" style="color: #5E5E5E;">+</span>+</span>
<span>  <span class="va" style="color: #111111;">mi_temagg</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/caret_r/caret_R_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="distribuciones" class="level2"><h2 class="anchored" data-anchor-id="distribuciones">Distribuciones</h2>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">df_pulsar</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op" style="color: #5E5E5E;">(</span>key <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"variable"</span>, value <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"valor"</span>, <span class="op" style="color: #5E5E5E;">-</span><span class="va" style="color: #111111;">pulsar</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span>data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">.</span>, <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">valor</span>, fill <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pulsar</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">~</span><span class="va" style="color: #111111;">variable</span>, scales <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"free"</span>, ncol <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">4</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op" style="color: #5E5E5E;">(</span>alpha <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.9</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">""</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Densidad"</span>, title <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Escala logarítmica"</span>",</span>
<span>       fill <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"¿Púlsar?"</span><span class="op" style="color: #5E5E5E;">)</span>"<span class="op" style="color: #5E5E5E;">+</span> +</span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op" style="color: #5E5E5E;">(</span>values <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"#790222"</span>, <span class="st" style="color: #20794D;">"#033660"</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="va" style="color: #111111;">mi_temagg</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/caret_r/caret_R_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section><section id="correlaciones" class="level2"><h2 class="anchored" data-anchor-id="correlaciones">Correlaciones</h2>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># Cargando biblioteca corrplot</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://github.com/taiyun/corrplot">corrplot</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;">df_pulsar</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_if</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">is.numeric</span>, <span class="va" style="color: #111111;">scale</span><span class="op" style="color: #5E5E5E;">)</span>  <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/select_all.html">select_if</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">is.numeric</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op" style="color: #5E5E5E;">(</span>method <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"spearman"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op" style="color: #5E5E5E;">(</span>method <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"pie"</span>, type <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"upper"</span>, order <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"hclust"</span>, diag <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">FALSE</span>,</span>
<span>           tl.srt <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">35</span>, tl.col <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"black"</span>, tl.cex <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/caret_r/caret_R_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="train-y-test" class="level1"><h1>Train y Test</h1>
<ul>
<li>La partición se hace 70 y 30%, para entrenamiento (<code>df_train</code>) y prueba (<code>df_test</code>), respectivamente.</li>
<li>El argumento <code>list = FALSE</code> en la función <code>createDataPartition</code>, permite que el objeto sea devuelto en forma de <code>vector</code>.</li>
<li><a href="https://topepo.github.io/caret/index.html">Documentación de biblioteca <code>caret</code>.</a></li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># Cargando biblioteca caret</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://github.com/topepo/caret/">caret</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Semilla para reproducir resutlados</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">073</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Particiones</span></span>
<span><span class="va" style="color: #111111;">idx</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/caret/man/createDataPartition.html">createDataPartition</a></span><span class="op" style="color: #5E5E5E;">(</span>y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">df_pulsar</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">pulsar</span>, times <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>, p <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.7</span>, list <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">FALSE</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">df_train</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">df_pulsar</span><span class="op" style="color: #5E5E5E;">[</span><span class="va" style="color: #111111;">idx</span>, <span class="op" style="color: #5E5E5E;">]</span></span>
<span><span class="va" style="color: #111111;">df_test</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">df_pulsar</span><span class="op" style="color: #5E5E5E;">[</span><span class="op" style="color: #5E5E5E;">-</span><span class="va" style="color: #111111;">idx</span>, <span class="op" style="color: #5E5E5E;">]</span></span></code></pre></div>
</details>
</div>
<ul>
<li><strong>Proporción de la variable respuesta en train y test:</strong></li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;">ggpubr</span><span class="fu" style="color: #4758AB;">::</span><span class="fu" style="color: #4758AB;"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>  <span class="va" style="color: #111111;">df_train</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">pulsar</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op" style="color: #5E5E5E;">(</span>prop <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">n</span><span class="op" style="color: #5E5E5E;">/</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">n</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span>data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">.</span>, <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pulsar</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">prop</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op" style="color: #5E5E5E;">(</span>color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"black"</span>, fill <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"#033660"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_label</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>label <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">prop</span>, digits <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"¿Púlsar?"</span>?", titl<span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Distribución en train"</span>in",</span>
<span>       subtitle <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"0=No\n1=Sí"</span><span class="op" style="color: #5E5E5E;">)</span>)<span class="op" style="color: #5E5E5E;">+</span>+</span>
<span>  <span class="va" style="color: #111111;">mi_temagg</span>,</span>
<span></span>
<span>  <span class="va" style="color: #111111;">df_test</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">pulsar</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op" style="color: #5E5E5E;">(</span>prop <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">n</span><span class="op" style="color: #5E5E5E;">/</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">n</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span>data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">.</span>, <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pulsar</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">prop</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op" style="color: #5E5E5E;">(</span>color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"black"</span>, fill <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"#033660"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_label</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>label <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">prop</span>, digits <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"¿Púlsar?"</span>?", titl<span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Distribución en test"</span>st",</span>
<span>       subtitle <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"0=No\n1=Sí"</span><span class="op" style="color: #5E5E5E;">)</span>)<span class="op" style="color: #5E5E5E;">+</span>+</span>
<span>  <span class="va" style="color: #111111;">mi_temagg</span>,</span>
<span>  </span>
<span>  ncol <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">2</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/caret_r/caret_R_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="modelos" class="level1"><h1>Modelos</h1>
<ul>
<li>Se utiliza el método <code>ranger</code>.</li>
<li>Los argumentos se han dejado como están por defecto.</li>
<li><a href="http://topepo.github.io/caret/train-models-by-tag.html#random-forest">Referencia de algoritmo random forest con caret.</a></li>
<li>En este caso particular se usa el método <code>ranger</code> que permite ajustar tres hiperparámetros:
<ul>
<li>
<code>mtry</code>: número de predictores seleccionados.</li>
<li>
<code>splitrule</code>: criterio de división. En problemas de clasificación se suele utilizar <code>Gini</code>, aunque hay más disponibles. <a href="https://cran.r-project.org/web/packages/ranger/ranger.pdf">Ver documentación de <code>ranger</code>.</a>
</li>
<li>
<code>min.node.size</code>: número mínimo de observaciones en cada nodo. Por defecto para problemas de clasificación es 1.</li>
</ul>
</li>
</ul>
<section id="random-forest" class="level2"><h2 class="anchored" data-anchor-id="random-forest">Random Forest</h2>
<section id="algoritmo" class="level3"><h3 class="anchored" data-anchor-id="algoritmo">Algoritmo</h3>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># Algoritmo de random forest</span></span>
<span><span class="va" style="color: #111111;">modelo_rf</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">pulsar</span> <span class="op" style="color: #5E5E5E;">~</span> <span class="va" style="color: #111111;">.</span>, data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">df_train</span>, method <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"ranger"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Guardando modelo</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op" style="color: #5E5E5E;">(</span>object <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">modelo_rf</span>, file <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"models_fit/RandomForest.rds"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details>
</div>
<ul>
<li><strong>Resultados:</strong></li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># Cargando modelo</span></span>
<span><span class="va" style="color: #111111;">mod_rf</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"models_fit/RandomForest.rds"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Resultados del modelo</span></span>
<span><span class="va" style="color: #111111;">mod_rf</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Random Forest 

12530 samples
    8 predictor
    2 classes: '0', '1' 

No pre-processing
Resampling: Bootstrapped (25 reps) 
Summary of sample sizes: 12530, 12530, 12530, 12530, 12530, 12530, ... 
Resampling results across tuning parameters:

  mtry  splitrule   Accuracy   Kappa    
  2     gini        0.9801226  0.8758954
  2     extratrees  0.9794474  0.8705685
  5     gini        0.9801169  0.8762727
  5     extratrees  0.9803843  0.8777407
  8     gini        0.9795793  0.8731006
  8     extratrees  0.9804887  0.8788098

Tuning parameter 'min.node.size' was held constant at a value of 1
Accuracy was used to select the optimal model using the largest value.
The final values used for the model were mtry = 8, splitrule = extratrees
 and min.node.size = 1.</code></pre>
</div>
</div>
</section><section id="desempeño" class="level3"><h3 class="anchored" data-anchor-id="desempeño">Desempeño</h3>
<ul>
<li><strong>Matriz de confusión en test:</strong></li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># Predicciones en nuevos datos</span></span>
<span><span class="va" style="color: #111111;">predict_rf</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;">(</span>object <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">mod_rf</span>, newdata <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">df_test</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Matriz de confución</span>n</span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/caret/man/confusionMatrix.html">confusionMatrix</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">predict_rf</span>, <span class="va" style="color: #111111;">df_test</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">pulsar</span>, positive <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"1"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 4840   84
         1   37  407
                                          
               Accuracy : 0.9775          
                 95% CI : (0.9731, 0.9813)
    No Information Rate : 0.9085          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.8583          
                                          
 Mcnemar's Test P-Value : 2.892e-05       
                                          
            Sensitivity : 0.82892         
            Specificity : 0.99241         
         Pos Pred Value : 0.91667         
         Neg Pred Value : 0.98294         
             Prevalence : 0.09147         
         Detection Rate : 0.07582         
   Detection Prevalence : 0.08271         
      Balanced Accuracy : 0.91067         
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
</div>
</section></section><section id="svm" class="level2"><h2 class="anchored" data-anchor-id="svm">SVM</h2>
<ul>
<li>Se utiliza el método <code>svmRadial</code> que está contenido en la biblioteca <code>kernlab</code>.</li>
<li>La configuración está por defecto.</li>
<li>Este algoritmo permite ajustar hiperparámetros <code>sigma</code> y <code>C</code> (costo).</li>
<li><a href="https://cran.r-project.org/web/packages/kernlab/kernlab.pdf">Documentación <code>kernlab</code>.</a></li>
</ul>
<section id="algoritmo-1" class="level3"><h3 class="anchored" data-anchor-id="algoritmo-1">Algoritmo</h3>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># Algoritmo</span></span>
<span><span class="va" style="color: #111111;">modelo_svmR</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">pulsar</span> <span class="op" style="color: #5E5E5E;">~</span> <span class="va" style="color: #111111;">.</span>, data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">df_train</span>, method <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"svmRadial"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Guardando modelo</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op" style="color: #5E5E5E;">(</span>object <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">modelo_svmR</span>, file <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"models_fit/SVM_Radial.rds"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details>
</div>
<ul>
<li><strong>Resultados:</strong></li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># Cargando modelo</span></span>
<span><span class="va" style="color: #111111;">mod_svmR</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"models_fit/SVM_Radial.rds"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Resultados del modelo</span></span>
<span><span class="va" style="color: #111111;">mod_svmR</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Support Vector Machines with Radial Basis Function Kernel 

12530 samples
    8 predictor
    2 classes: '0', '1' 

No pre-processing
Resampling: Bootstrapped (25 reps) 
Summary of sample sizes: 12530, 12530, 12530, 12530, 12530, 12530, ... 
Resampling results across tuning parameters:

  C     Accuracy   Kappa    
  0.25  0.9785764  0.8629191
  0.50  0.9785329  0.8635606
  1.00  0.9787235  0.8654589

Tuning parameter 'sigma' was held constant at a value of 0.4893064
Accuracy was used to select the optimal model using the largest value.
The final values used for the model were sigma = 0.4893064 and C = 1.</code></pre>
</div>
</div>
</section><section id="desempeño-1" class="level3"><h3 class="anchored" data-anchor-id="desempeño-1">Desempeño</h3>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">predict_svmR</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;">(</span>object <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">mod_svmR</span>, newdata <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">df_test</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/caret/man/confusionMatrix.html">confusionMatrix</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">predict_svmR</span>, <span class="va" style="color: #111111;">df_test</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">pulsar</span>, positive <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"1"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 4852   95
         1   25  396
                                          
               Accuracy : 0.9776          
                 95% CI : (0.9733, 0.9814)
    No Information Rate : 0.9085          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.8563          
                                          
 Mcnemar's Test P-Value : 2.999e-10       
                                          
            Sensitivity : 0.80652         
            Specificity : 0.99487         
         Pos Pred Value : 0.94062         
         Neg Pred Value : 0.98080         
             Prevalence : 0.09147         
         Detection Rate : 0.07377         
   Detection Prevalence : 0.07843         
      Balanced Accuracy : 0.90070         
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
</div>
</section></section><section id="comparación-de-modelos" class="level2"><h2 class="anchored" data-anchor-id="comparación-de-modelos">Comparación de modelos</h2>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">mod_svmR</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">resample</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">-</span><span class="va" style="color: #111111;">Resample</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op" style="color: #5E5E5E;">(</span>Modelo <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"SVM"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">mod_rf</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">resample</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">-</span><span class="va" style="color: #111111;">Resample</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://tidyr.tidyverse.org/reference/replace_na.html">replace_na</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;">(</span>Modelo <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Random Forest"</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op" style="color: #5E5E5E;">(</span>key <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Medida"</span>, value <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Valor"</span>, <span class="op" style="color: #5E5E5E;">-</span><span class="va" style="color: #111111;">Modelo</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span>data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">.</span>, <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">Modelo</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">Valor</span>, fill <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">Modelo</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">~</span><span class="va" style="color: #111111;">Medida</span>, scales <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"free"</span>, ncol <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op" style="color: #5E5E5E;">(</span>alpha <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.9</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op" style="color: #5E5E5E;">(</span>fun <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">mean</span>, geom <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"point"</span>, pch <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">19</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;">(</span>y <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">""</span>, title <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Comparación de modelos"</span>",</span>
<span>       subtitle <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Predicción de estrellas púlsar"</span><span class="op" style="color: #5E5E5E;">)</span>"<span class="op" style="color: #5E5E5E;">+</span> +</span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op" style="color: #5E5E5E;">(</span>values <span class="op" style="color: #5E5E5E;">=</span>  <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"#790222"</span>, <span class="st" style="color: #20794D;">"#033660"</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="va" style="color: #111111;">mi_temagg</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op" style="color: #5E5E5E;">(</span>legend.position <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"none"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/caret_r/caret_R_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


<!-- -->

</section></section> ]]></description>
  <category>R</category>
  <category>caret</category>
  <category>ML</category>
  <guid>https://blogrpy.netlify.app/posts/caret_r/caret_R.html</guid>
  <pubDate>Mon, 23 Mar 2020 05:00:00 GMT</pubDate>
  <media:content url="https://blogrpy.netlify.app/posts/caret_r/img2.png " medium="image"/>
</item>
<item>
  <title>R + Python: I</title>
  <dc:creator>Edimer (Sidereus)</dc:creator>
  <link>https://blogrpy.netlify.app/posts/pyr1/Py_R_1.html</link>
  <description><![CDATA[ <section id="requisitos-previos" class="level1"><h1>Requisitos previos</h1>
<ul>
<li>Tener instalado <a href="https://www.python.org/">Python</a>
</li>
<li>Recomendable instalar <a href="https://anaconda.org/anaconda/anaconda-navigator">Anaconda Navigator</a>
</li>
<li>Instalar la biblioteca <a href="https://rstudio.github.io/reticulate/index.html"><code>reticulate</code></a> desde R.</li>
</ul></section><section id="biblioteca-reticulate" class="level1"><h1>Biblioteca Reticulate</h1>
<center>
<img src="https://blogrpy.netlify.app/posts/pyr1/https:/rstudio.github.io/reticulate/images/reticulated_python.png" width="150">
</center>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://rstudio.github.io/reticulate/">reticulate</a></span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details>
</div>
</section><section id="requisitos-previos-1" class="level1"><h1>Requisitos previos</h1>
<ul>
<li>Tener instalado <a href="https://www.python.org/">Python</a>
</li>
<li>Recomendable instalar <a href="https://anaconda.org/anaconda/anaconda-navigator">Anaconda Navigator</a>
</li>
<li>Instalar la biblioteca <a href="https://rstudio.github.io/reticulate/index.html"><code>reticulate</code></a> desde R.</li>
</ul></section><section id="biblioteca-reticulate-1" class="level1"><h1>Biblioteca Reticulate</h1>
<center>
<img src="https://blogrpy.netlify.app/posts/pyr1/https:/rstudio.github.io/reticulate/images/reticulated_python.png" width="150">
</center>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://rstudio.github.io/reticulate/">reticulate</a></span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details>
</div>
</section><section id="importando-módulos-de-python" class="level1"><h1>Importando módulos de <em>python</em>
</h1>
<section id="importando-numpy" class="level2"><h2 class="anchored" data-anchor-id="importando-numpy">Importando <code>numpy</code>
</h2>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">np</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rstudio.github.io/reticulate/reference/import.html">import</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"numpy"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">np</span><span class="op" style="color: #5E5E5E;">$</span><span class="fu" style="color: #4758AB;">argmin</span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">2</span>, <span class="fl" style="color: #AD0000;">1</span>, <span class="fl" style="color: #AD0000;">3</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<ul>
<li>En esta salida se muestra cómo aplicar la función <code>arcgmin</code> de <em>python</em> sobre un vector de <em>R</em>. Devuelve la posición (índice) donde se encuentra el valor mínimo del vector dado.</li>
<li>Es posible acceder a todas las funciones de <code>numpy</code> desde el objeto <code>np</code> con el símbolo dólar <code>$</code>.</li>
</ul>
<center>
<img src="https://blogrpy.netlify.app/posts/pyr1/img1.png" width="650/">
</center>
</section><section id="importando-os" class="level2"><h2 class="anchored" data-anchor-id="importando-os">Importando <code>os</code>
</h2>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">os</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rstudio.github.io/reticulate/reference/import.html">import</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"os"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">os</span><span class="op" style="color: #5E5E5E;">$</span><span class="fu" style="color: #4758AB;">getcwd</span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "D:\\Otros\\Github\\web-edimer\\web-edimer.github.io\\posts\\pyr1"</code></pre>
</div>
</div>
</section></section><section id="usando-python" class="level1"><h1>Usando <em>python</em>
</h1>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="im" style="color: #00769E;">import</span> numpy <span class="im" style="color: #00769E;">as</span> np</span>
<span id="cb7-2">np.argmax(np.array([<span class="dv" style="color: #AD0000;">1</span>, <span class="dv" style="color: #AD0000;">4</span>, <span class="dv" style="color: #AD0000;">10</span>]))</span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>2</code></pre>
</div>
</div>
</section><section id="función-de-python-llamada-por-r" class="level1"><h1>Función de <em>python</em> llamada por <em>R</em>
</h1>
<ul>
<li>Declarando la función en <em>python</em>:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="kw" style="color: #003B4F;">def</span> add(x, y):</span>
<span id="cb9-2">  <span class="cf" style="color: #003B4F;">return</span> x <span class="op" style="color: #5E5E5E;">+</span> y</span>
<span id="cb9-3">  </span>
<span id="cb9-4">add(<span class="dv" style="color: #AD0000;">2</span>, <span class="dv" style="color: #AD0000;">2</span>)  </span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>4</code></pre>
</div>
</div>
<ul>
<li>Llamando la función <code>add()</code> desde <em>R</em>
</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">py</span><span class="op" style="color: #5E5E5E;">$</span><span class="fu" style="color: #4758AB;">add</span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">2</span>, <span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
</section><section id="usando-numpy" class="level1"><h1>Usando <code>numpy</code>
</h1>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1">np.arange(<span class="dv" style="color: #AD0000;">0</span>, <span class="dv" style="color: #AD0000;">5</span>)</span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>array([0, 1, 2, 3, 4])</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1">np.arange(<span class="dv" style="color: #AD0000;">0</span>, <span class="dv" style="color: #AD0000;">10</span>, <span class="dv" style="color: #AD0000;">2</span>)</span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>array([0, 2, 4, 6, 8])</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">np.ones((<span class="dv" style="color: #AD0000;">2</span>, <span class="dv" style="color: #AD0000;">2</span>))</span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>array([[1., 1.],
       [1., 1.]])</code></pre>
</div>
</div>
<ul>
<li>
<strong>Simulando 100 valores aleatorios de la distribución normal, con media 2 y varianza 3:</strong>.</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1">np.random.seed(<span class="dv" style="color: #AD0000;">1</span>)</span>
<span id="cb19-2">valores <span class="op" style="color: #5E5E5E;">=</span> np.random.normal(loc <span class="op" style="color: #5E5E5E;">=</span> <span class="dv" style="color: #AD0000;">2</span>, scale <span class="op" style="color: #5E5E5E;">=</span> <span class="dv" style="color: #AD0000;">3</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="dv" style="color: #AD0000;">100</span>)</span>
<span id="cb19-3">valores</span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>array([ 6.87303609,  0.16473076,  0.41548474, -1.21890587,  4.59622289,
       -4.90461609,  7.23443529, -0.2836207 ,  2.95711729,  1.25188887,
        6.38632381, -4.18042213,  1.03274839,  0.84783694,  5.40130833,
       -1.2996738 ,  1.48271538, -0.63357525,  2.12664124,  3.74844564,
       -1.30185753,  5.43417113,  4.70477216,  3.50748302,  4.70256785,
       -0.05118358,  1.63132932, -0.8073083 ,  1.19633576,  3.5910664 ,
       -0.07498226,  0.80973942, -0.0615181 , -0.53561692, -0.01373839,
        1.9620062 , -1.35193105,  2.70324709,  6.97940653,  4.22613248,
        1.42449334, -0.66288689, -0.24147488,  7.0773638 ,  2.15242326,
        0.08901306,  2.57274645,  8.30076541,  2.36047686,  3.85160933,
        2.90051096,  0.94325046, -1.42755459,  0.95197183,  1.3733173 ,
        3.75986957,  4.51695024,  4.79330624,  2.85676198,  4.65542349,
       -0.26319382,  5.75860447,  3.53878946,  1.10572149,  3.46555444,
        1.77328486,  5.39488816,  6.55945045,  8.55672622, -2.18948901,
       -2.33234142,  0.48660241,  2.48011121,  4.62850676,  2.94690484,
       -4.06660365,  1.08138796,  4.48392393,  2.69028421,  4.28603354,
        1.33301557,  1.39772579,  2.55968417,  3.23015494,  2.59489916,
        2.35702594, -0.01198686,  3.13269136,  2.36546381,  5.38845172,
        5.59675364,  2.55546925,  0.87414515,  0.08380878,  3.27048306,
        2.23202021,  0.96843897,  2.13079057,  0.13999747,  4.0940961 ])</code></pre>
</div>
</div>
</section><section id="gráfico-con-matplotlib" class="level1"><h1>Gráfico con <code>matplotlib</code>
</h1>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="im" style="color: #00769E;">import</span> matplotlib</span>
<span id="cb21-2"><span class="im" style="color: #00769E;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;">as</span> plt</span>
<span id="cb21-3"></span>
<span id="cb21-4">fig, g1 <span class="op" style="color: #5E5E5E;">=</span> plt.subplots()</span>
<span id="cb21-5">g1 <span class="op" style="color: #5E5E5E;">=</span> g1.hist(valores, bins <span class="op" style="color: #5E5E5E;">=</span> <span class="dv" style="color: #AD0000;">30</span>)</span>
<span id="cb21-6">g1 <span class="op" style="color: #5E5E5E;">=</span> plt.grid()</span>
<span id="cb21-7">g1</span></code></pre></div>
</details>
</div>
<center>
<img src="https://blogrpy.netlify.app/posts/pyr1/plt1.png">
</center>
</section><section id="ayudas" class="level1"><h1>Ayudas</h1>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">os</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rstudio.github.io/reticulate/reference/import.html">import</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"os"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rstudio.github.io/reticulate/reference/py_help.html">py_help</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">os</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">chdir</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details>
</div>
<p>En el editor de texto aparecerá el siguiente texto:</p>
<center>
<img src="https://blogrpy.netlify.app/posts/pyr1/img2.png" width="650/">
</center>
</section><section id="objetos" class="level1"><h1>Objetos</h1>
<section id="tupla-desde-r" class="level2"><h2 class="anchored" data-anchor-id="tupla-desde-r">Tupla desde <em>R</em>
</h2>
<ul>
<li>Creando una tupla y obteniendo su clase:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">tupla1</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rstudio.github.io/reticulate/reference/tuple.html">tuple</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span>, <span class="fl" style="color: #AD0000;">2</span>, <span class="fl" style="color: #AD0000;">3</span>, <span class="st" style="color: #20794D;">"A"</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">tupla1</span></span>
<span><span class="co" style="color: #5E5E5E;">## (['1', '2', '3', 'A'],)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Clase en python</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">tupla1</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="co" style="color: #5E5E5E;">## [1] "python.builtin.tuple"  "python.builtin.object"</span></span></code></pre></div>
</details>
</div>
<ul>
<li>Coercionar el objeto <code>tupla1</code> de clase <code>tuple</code> en <em>python</em> directamente a <em>R</em>:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">tupla1_r</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rstudio.github.io/reticulate/reference/r-py-conversion.html">py_to_r</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">tupla1</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">tupla1_r</span></span>
<span><span class="co" style="color: #5E5E5E;">## [[1]]</span></span>
<span><span class="co" style="color: #5E5E5E;">## [1] "1" "2" "3" "A"</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Clase en R</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">tupla1_r</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="co" style="color: #5E5E5E;">## [1] "list"</span></span></code></pre></div>
</details>
</div>
</section><section id="diccionario-desde-r" class="level2"><h2 class="anchored" data-anchor-id="diccionario-desde-r">Diccionario desde <em>R</em>
</h2>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># Objeto</span></span>
<span><span class="va" style="color: #111111;">dict1</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rstudio.github.io/reticulate/reference/dict.html">dict</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Hola"</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">3.5</span>, z <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1L</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">dict1</span></span>
<span><span class="co" style="color: #5E5E5E;">## {'x': 'Hola', 'y': 3.5, 'z': 1}</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Clase</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">dict1</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="co" style="color: #5E5E5E;">## [1] "python.builtin.dict"   "python.builtin.object"</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Nombres</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">dict1</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="co" style="color: #5E5E5E;">## [1] "x" "y" "z"</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Atributos</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">dict1</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="co" style="color: #5E5E5E;">## $class</span></span>
<span><span class="co" style="color: #5E5E5E;">## [1] "python.builtin.dict"   "python.builtin.object"</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Coerción a objeto R</span>R</span>
<span><span class="va" style="color: #111111;">dict1_r</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rstudio.github.io/reticulate/reference/r-py-conversion.html">py_to_r</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">dict1</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">dict1_r</span></span>
<span><span class="co" style="color: #5E5E5E;">## $x</span></span>
<span><span class="co" style="color: #5E5E5E;">## [1] "Hola"</span></span>
<span><span class="co" style="color: #5E5E5E;">## </span></span>
<span><span class="co" style="color: #5E5E5E;">## $y</span></span>
<span><span class="co" style="color: #5E5E5E;">## [1] 3.5</span></span>
<span><span class="co" style="color: #5E5E5E;">## </span></span>
<span><span class="co" style="color: #5E5E5E;">## $z</span></span>
<span><span class="co" style="color: #5E5E5E;">## [1] 1</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Clase en R</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">dict1_r</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="co" style="color: #5E5E5E;">## [1] "list"</span></span></code></pre></div>
</details>
</div>
</section><section id="tupla-en-python" class="level2"><h2 class="anchored" data-anchor-id="tupla-en-python">Tupla en <em>python</em>
</h2>
<ul>
<li>Creando tupla en <em>python</em>:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><span class="co" style="color: #5E5E5E;"># Creando tupla</span></span>
<span id="cb26-2">altura <span class="op" style="color: #5E5E5E;">=</span> (<span class="fl" style="color: #AD0000;">1.65</span>, <span class="fl" style="color: #AD0000;">1.72</span>, <span class="fl" style="color: #AD0000;">1.56</span>, <span class="fl" style="color: #AD0000;">1.84</span>, <span class="fl" style="color: #AD0000;">1.92</span>)</span>
<span id="cb26-3">altura</span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>(1.65, 1.72, 1.56, 1.84, 1.92)</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><span class="co" style="color: #5E5E5E;"># Otra tupla</span></span>
<span id="cb28-2">peso <span class="op" style="color: #5E5E5E;">=</span> (<span class="dv" style="color: #AD0000;">67</span>, <span class="dv" style="color: #AD0000;">75</span>, <span class="dv" style="color: #AD0000;">67</span>, <span class="dv" style="color: #AD0000;">78</span>, <span class="dv" style="color: #AD0000;">85</span>)</span>
<span id="cb28-3">peso</span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>(67, 75, 67, 78, 85)</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><span class="co" style="color: #5E5E5E;"># Tipo (clase) de objetos</span></span>
<span id="cb30-2"><span class="bu" style="color: null;">type</span>(altura)</span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'tuple'&gt;</code></pre>
</div>
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><span class="bu" style="color: null;">type</span>(peso)</span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'tuple'&gt;</code></pre>
</div>
</div>
<ul>
<li>Llamando la tupla desde <em>R</em>:</li>
</ul>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode" id="cb34" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">py</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">altura</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="co" style="color: #5E5E5E;">## [1] "list"</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">py</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">altura</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">py</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">peso</span>, pch <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">19</span>, cex <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://blogrpy.netlify.app/posts/pyr1/Py_R_1_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="tipos-de-objetos-en-ambos-lenguajes" class="level2"><h2 class="anchored" data-anchor-id="tipos-de-objetos-en-ambos-lenguajes">Tipos de objetos en ambos lenguajes</h2>
<center>
<img src="https://blogrpy.netlify.app/posts/pyr1/img3.png" width="650/">
</center>
</section></section><section id="índices" class="level1"><h1>Índices</h1>
<ul>
<li>Desde <em>python</em>:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1">altura</span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>(1.65, 1.72, 1.56, 1.84, 1.92)</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1">altura[<span class="dv" style="color: #AD0000;">0</span>]</span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>1.65</code></pre>
</div>
</div>
<ul>
<li>En <em>R</em>:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb39" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">py</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">altura</span><span class="op" style="color: #5E5E5E;">[</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">]</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 1.65</code></pre>
</div>
</div>
</section><section id="instalando-un-módulo-de-python-desde-r" class="level1"><h1>Instalando un módulo de <em>python</em> desde <em>R</em>
</h1>
<section id="instalando-pandas" class="level2"><h2 class="anchored" data-anchor-id="instalando-pandas">Instalando <code>pandas</code>
</h2>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb41" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rstudio.github.io/reticulate/reference/py_install.html">py_install</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"pandas"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details>
</div>
</section><section id="importando-pandas-y-leyendo-archivo-.csv" class="level2"><h2 class="anchored" data-anchor-id="importando-pandas-y-leyendo-archivo-.csv">Importando <code>pandas</code> y leyendo archivo <em>.csv</em>
</h2>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><span class="im" style="color: #00769E;">import</span> pandas <span class="im" style="color: #00769E;">as</span> pd</span>
<span id="cb42-2">iris_py <span class="op" style="color: #5E5E5E;">=</span> pd.read_csv(<span class="st" style="color: #20794D;">"Iris.csv"</span>)</span>
<span id="cb42-3">iris_py</span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     Sepal.Length  Sepal.Width  Petal.Length  Petal.Width    Species
0             5.1          3.5           1.4          0.2     setosa
1             4.9          3.0           1.4          0.2     setosa
2             4.7          3.2           1.3          0.2     setosa
3             4.6          3.1           1.5          0.2     setosa
4             5.0          3.6           1.4          0.2     setosa
..            ...          ...           ...          ...        ...
145           6.7          3.0           5.2          2.3  virginica
146           6.3          2.5           5.0          1.9  virginica
147           6.5          3.0           5.2          2.0  virginica
148           6.2          3.4           5.4          2.3  virginica
149           5.9          3.0           5.1          1.8  virginica

[150 rows x 5 columns]</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><span class="bu" style="color: null;">type</span>(iris_py)</span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;</code></pre>
</div>
</div>
<ul>
<li>Estadísticos descriptivos:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1">iris_py.describe()</span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>       Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
count    150.000000   150.000000    150.000000   150.000000
mean       5.843333     3.057333      3.758000     1.199333
std        0.828066     0.435866      1.765298     0.762238
min        4.300000     2.000000      1.000000     0.100000
25%        5.100000     2.800000      1.600000     0.300000
50%        5.800000     3.000000      4.350000     1.300000
75%        6.400000     3.300000      5.100000     1.800000
max        7.900000     4.400000      6.900000     2.500000</code></pre>
</div>
</div>
<ul>
<li>Seleccionando variables por nombre:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1">iris_py[[<span class="st" style="color: #20794D;">"Sepal.Length"</span>, <span class="st" style="color: #20794D;">"Sepal.Width"</span>]]</span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     Sepal.Length  Sepal.Width
0             5.1          3.5
1             4.9          3.0
2             4.7          3.2
3             4.6          3.1
4             5.0          3.6
..            ...          ...
145           6.7          3.0
146           6.3          2.5
147           6.5          3.0
148           6.2          3.4
149           5.9          3.0

[150 rows x 2 columns]</code></pre>
</div>
</div>
<ul>
<li>Filtrando datos:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1">filtro <span class="op" style="color: #5E5E5E;">=</span> iris_py[<span class="st" style="color: #20794D;">"Sepal.Width"</span>] <span class="op" style="color: #5E5E5E;">&lt;=</span> <span class="fl" style="color: #AD0000;">2.2</span></span>
<span id="cb50-2">iris_py[filtro]</span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     Sepal.Length  Sepal.Width  Petal.Length  Petal.Width     Species
60            5.0          2.0           3.5          1.0  versicolor
62            6.0          2.2           4.0          1.0  versicolor
68            6.2          2.2           4.5          1.5  versicolor
119           6.0          2.2           5.0          1.5   virginica</code></pre>
</div>
</div>
<ul>
<li>
<code>Dataframe</code> como <code>array</code>:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1">iris_py.values</span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>array([[5.1, 3.5, 1.4, 0.2, 'setosa'],
       [4.9, 3.0, 1.4, 0.2, 'setosa'],
       [4.7, 3.2, 1.3, 0.2, 'setosa'],
       [4.6, 3.1, 1.5, 0.2, 'setosa'],
       [5.0, 3.6, 1.4, 0.2, 'setosa'],
       [5.4, 3.9, 1.7, 0.4, 'setosa'],
       [4.6, 3.4, 1.4, 0.3, 'setosa'],
       [5.0, 3.4, 1.5, 0.2, 'setosa'],
       [4.4, 2.9, 1.4, 0.2, 'setosa'],
       [4.9, 3.1, 1.5, 0.1, 'setosa'],
       [5.4, 3.7, 1.5, 0.2, 'setosa'],
       [4.8, 3.4, 1.6, 0.2, 'setosa'],
       [4.8, 3.0, 1.4, 0.1, 'setosa'],
       [4.3, 3.0, 1.1, 0.1, 'setosa'],
       [5.8, 4.0, 1.2, 0.2, 'setosa'],
       [5.7, 4.4, 1.5, 0.4, 'setosa'],
       [5.4, 3.9, 1.3, 0.4, 'setosa'],
       [5.1, 3.5, 1.4, 0.3, 'setosa'],
       [5.7, 3.8, 1.7, 0.3, 'setosa'],
       [5.1, 3.8, 1.5, 0.3, 'setosa'],
       [5.4, 3.4, 1.7, 0.2, 'setosa'],
       [5.1, 3.7, 1.5, 0.4, 'setosa'],
       [4.6, 3.6, 1.0, 0.2, 'setosa'],
       [5.1, 3.3, 1.7, 0.5, 'setosa'],
       [4.8, 3.4, 1.9, 0.2, 'setosa'],
       [5.0, 3.0, 1.6, 0.2, 'setosa'],
       [5.0, 3.4, 1.6, 0.4, 'setosa'],
       [5.2, 3.5, 1.5, 0.2, 'setosa'],
       [5.2, 3.4, 1.4, 0.2, 'setosa'],
       [4.7, 3.2, 1.6, 0.2, 'setosa'],
       [4.8, 3.1, 1.6, 0.2, 'setosa'],
       [5.4, 3.4, 1.5, 0.4, 'setosa'],
       [5.2, 4.1, 1.5, 0.1, 'setosa'],
       [5.5, 4.2, 1.4, 0.2, 'setosa'],
       [4.9, 3.1, 1.5, 0.2, 'setosa'],
       [5.0, 3.2, 1.2, 0.2, 'setosa'],
       [5.5, 3.5, 1.3, 0.2, 'setosa'],
       [4.9, 3.6, 1.4, 0.1, 'setosa'],
       [4.4, 3.0, 1.3, 0.2, 'setosa'],
       [5.1, 3.4, 1.5, 0.2, 'setosa'],
       [5.0, 3.5, 1.3, 0.3, 'setosa'],
       [4.5, 2.3, 1.3, 0.3, 'setosa'],
       [4.4, 3.2, 1.3, 0.2, 'setosa'],
       [5.0, 3.5, 1.6, 0.6, 'setosa'],
       [5.1, 3.8, 1.9, 0.4, 'setosa'],
       [4.8, 3.0, 1.4, 0.3, 'setosa'],
       [5.1, 3.8, 1.6, 0.2, 'setosa'],
       [4.6, 3.2, 1.4, 0.2, 'setosa'],
       [5.3, 3.7, 1.5, 0.2, 'setosa'],
       [5.0, 3.3, 1.4, 0.2, 'setosa'],
       [7.0, 3.2, 4.7, 1.4, 'versicolor'],
       [6.4, 3.2, 4.5, 1.5, 'versicolor'],
       [6.9, 3.1, 4.9, 1.5, 'versicolor'],
       [5.5, 2.3, 4.0, 1.3, 'versicolor'],
       [6.5, 2.8, 4.6, 1.5, 'versicolor'],
       [5.7, 2.8, 4.5, 1.3, 'versicolor'],
       [6.3, 3.3, 4.7, 1.6, 'versicolor'],
       [4.9, 2.4, 3.3, 1.0, 'versicolor'],
       [6.6, 2.9, 4.6, 1.3, 'versicolor'],
       [5.2, 2.7, 3.9, 1.4, 'versicolor'],
       [5.0, 2.0, 3.5, 1.0, 'versicolor'],
       [5.9, 3.0, 4.2, 1.5, 'versicolor'],
       [6.0, 2.2, 4.0, 1.0, 'versicolor'],
       [6.1, 2.9, 4.7, 1.4, 'versicolor'],
       [5.6, 2.9, 3.6, 1.3, 'versicolor'],
       [6.7, 3.1, 4.4, 1.4, 'versicolor'],
       [5.6, 3.0, 4.5, 1.5, 'versicolor'],
       [5.8, 2.7, 4.1, 1.0, 'versicolor'],
       [6.2, 2.2, 4.5, 1.5, 'versicolor'],
       [5.6, 2.5, 3.9, 1.1, 'versicolor'],
       [5.9, 3.2, 4.8, 1.8, 'versicolor'],
       [6.1, 2.8, 4.0, 1.3, 'versicolor'],
       [6.3, 2.5, 4.9, 1.5, 'versicolor'],
       [6.1, 2.8, 4.7, 1.2, 'versicolor'],
       [6.4, 2.9, 4.3, 1.3, 'versicolor'],
       [6.6, 3.0, 4.4, 1.4, 'versicolor'],
       [6.8, 2.8, 4.8, 1.4, 'versicolor'],
       [6.7, 3.0, 5.0, 1.7, 'versicolor'],
       [6.0, 2.9, 4.5, 1.5, 'versicolor'],
       [5.7, 2.6, 3.5, 1.0, 'versicolor'],
       [5.5, 2.4, 3.8, 1.1, 'versicolor'],
       [5.5, 2.4, 3.7, 1.0, 'versicolor'],
       [5.8, 2.7, 3.9, 1.2, 'versicolor'],
       [6.0, 2.7, 5.1, 1.6, 'versicolor'],
       [5.4, 3.0, 4.5, 1.5, 'versicolor'],
       [6.0, 3.4, 4.5, 1.6, 'versicolor'],
       [6.7, 3.1, 4.7, 1.5, 'versicolor'],
       [6.3, 2.3, 4.4, 1.3, 'versicolor'],
       [5.6, 3.0, 4.1, 1.3, 'versicolor'],
       [5.5, 2.5, 4.0, 1.3, 'versicolor'],
       [5.5, 2.6, 4.4, 1.2, 'versicolor'],
       [6.1, 3.0, 4.6, 1.4, 'versicolor'],
       [5.8, 2.6, 4.0, 1.2, 'versicolor'],
       [5.0, 2.3, 3.3, 1.0, 'versicolor'],
       [5.6, 2.7, 4.2, 1.3, 'versicolor'],
       [5.7, 3.0, 4.2, 1.2, 'versicolor'],
       [5.7, 2.9, 4.2, 1.3, 'versicolor'],
       [6.2, 2.9, 4.3, 1.3, 'versicolor'],
       [5.1, 2.5, 3.0, 1.1, 'versicolor'],
       [5.7, 2.8, 4.1, 1.3, 'versicolor'],
       [6.3, 3.3, 6.0, 2.5, 'virginica'],
       [5.8, 2.7, 5.1, 1.9, 'virginica'],
       [7.1, 3.0, 5.9, 2.1, 'virginica'],
       [6.3, 2.9, 5.6, 1.8, 'virginica'],
       [6.5, 3.0, 5.8, 2.2, 'virginica'],
       [7.6, 3.0, 6.6, 2.1, 'virginica'],
       [4.9, 2.5, 4.5, 1.7, 'virginica'],
       [7.3, 2.9, 6.3, 1.8, 'virginica'],
       [6.7, 2.5, 5.8, 1.8, 'virginica'],
       [7.2, 3.6, 6.1, 2.5, 'virginica'],
       [6.5, 3.2, 5.1, 2.0, 'virginica'],
       [6.4, 2.7, 5.3, 1.9, 'virginica'],
       [6.8, 3.0, 5.5, 2.1, 'virginica'],
       [5.7, 2.5, 5.0, 2.0, 'virginica'],
       [5.8, 2.8, 5.1, 2.4, 'virginica'],
       [6.4, 3.2, 5.3, 2.3, 'virginica'],
       [6.5, 3.0, 5.5, 1.8, 'virginica'],
       [7.7, 3.8, 6.7, 2.2, 'virginica'],
       [7.7, 2.6, 6.9, 2.3, 'virginica'],
       [6.0, 2.2, 5.0, 1.5, 'virginica'],
       [6.9, 3.2, 5.7, 2.3, 'virginica'],
       [5.6, 2.8, 4.9, 2.0, 'virginica'],
       [7.7, 2.8, 6.7, 2.0, 'virginica'],
       [6.3, 2.7, 4.9, 1.8, 'virginica'],
       [6.7, 3.3, 5.7, 2.1, 'virginica'],
       [7.2, 3.2, 6.0, 1.8, 'virginica'],
       [6.2, 2.8, 4.8, 1.8, 'virginica'],
       [6.1, 3.0, 4.9, 1.8, 'virginica'],
       [6.4, 2.8, 5.6, 2.1, 'virginica'],
       [7.2, 3.0, 5.8, 1.6, 'virginica'],
       [7.4, 2.8, 6.1, 1.9, 'virginica'],
       [7.9, 3.8, 6.4, 2.0, 'virginica'],
       [6.4, 2.8, 5.6, 2.2, 'virginica'],
       [6.3, 2.8, 5.1, 1.5, 'virginica'],
       [6.1, 2.6, 5.6, 1.4, 'virginica'],
       [7.7, 3.0, 6.1, 2.3, 'virginica'],
       [6.3, 3.4, 5.6, 2.4, 'virginica'],
       [6.4, 3.1, 5.5, 1.8, 'virginica'],
       [6.0, 3.0, 4.8, 1.8, 'virginica'],
       [6.9, 3.1, 5.4, 2.1, 'virginica'],
       [6.7, 3.1, 5.6, 2.4, 'virginica'],
       [6.9, 3.1, 5.1, 2.3, 'virginica'],
       [5.8, 2.7, 5.1, 1.9, 'virginica'],
       [6.8, 3.2, 5.9, 2.3, 'virginica'],
       [6.7, 3.3, 5.7, 2.5, 'virginica'],
       [6.7, 3.0, 5.2, 2.3, 'virginica'],
       [6.3, 2.5, 5.0, 1.9, 'virginica'],
       [6.5, 3.0, 5.2, 2.0, 'virginica'],
       [6.2, 3.4, 5.4, 2.3, 'virginica'],
       [5.9, 3.0, 5.1, 1.8, 'virginica']], dtype=object)</code></pre>
</div>
</div>
</section><section id="importando-tensorflow-desde-python" class="level2"><h2 class="anchored" data-anchor-id="importando-tensorflow-desde-python">Importando <code>tensorflow</code> desde python</h2>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><span class="im" style="color: #00769E;">import</span> tensorflow <span class="im" style="color: #00769E;">as</span> tf</span></code></pre></div>
</details>
</div>
<ul>
<li>Funciones desde <code>tf</code>:</li>
</ul>
<center>
<img src="https://blogrpy.netlify.app/posts/pyr1/img4.png" width="650/">
</center>
</section></section><section id="visualizando-datos-con-matplotlib" class="level1"><h1>Visualizando datos con <code>matplotlib</code>
</h1>
<section id="ejemplo-1" class="level2"><h2 class="anchored" data-anchor-id="ejemplo-1">Ejemplo 1</h2>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><span class="im" style="color: #00769E;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;">as</span> plt</span>
<span id="cb55-2">x <span class="op" style="color: #5E5E5E;">=</span> np.arange(<span class="dv" style="color: #AD0000;">0</span>, <span class="dv" style="color: #AD0000;">20</span>)</span>
<span id="cb55-3">y <span class="op" style="color: #5E5E5E;">=</span> x<span class="op" style="color: #5E5E5E;">**</span><span class="dv" style="color: #AD0000;">2</span></span>
<span id="cb55-4">g1 <span class="op" style="color: #5E5E5E;">=</span> plt.plot(x, y, <span class="st" style="color: #20794D;">"g--"</span>)</span>
<span id="cb55-5">g1 <span class="op" style="color: #5E5E5E;">=</span> plt.title(<span class="st" style="color: #20794D;">"X vs Y"</span>)</span>
<span id="cb55-6">g1 <span class="op" style="color: #5E5E5E;">=</span> plt.xlabel(<span class="st" style="color: #20794D;">"Eje x"</span>)</span>
<span id="cb55-7">g1 <span class="op" style="color: #5E5E5E;">=</span> plt.ylabel(<span class="st" style="color: #20794D;">"Eje Y"</span>)  </span>
<span id="cb55-8">g1</span></code></pre></div>
</details>
</div>
<center>
<img src="https://blogrpy.netlify.app/posts/pyr1/plt2.png">
</center>
</section><section id="ejemplo-2" class="level2"><h2 class="anchored" data-anchor-id="ejemplo-2">Ejemplo 2</h2>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1">w <span class="op" style="color: #5E5E5E;">=</span> np.arange(<span class="dv" style="color: #AD0000;">0</span>, <span class="dv" style="color: #AD0000;">50</span>).reshape(<span class="dv" style="color: #AD0000;">5</span>, <span class="dv" style="color: #AD0000;">10</span>)</span>
<span id="cb56-2">w</span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>array([[ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9],
       [10, 11, 12, 13, 14, 15, 16, 17, 18, 19],
       [20, 21, 22, 23, 24, 25, 26, 27, 28, 29],
       [30, 31, 32, 33, 34, 35, 36, 37, 38, 39],
       [40, 41, 42, 43, 44, 45, 46, 47, 48, 49]])</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1">g2 <span class="op" style="color: #5E5E5E;">=</span> plt.imshow(w)</span>
<span id="cb58-2">g2 <span class="op" style="color: #5E5E5E;">=</span> plt.colorbar()</span>
<span id="cb58-3">plt.show()</span></code></pre></div>
</details>
</div>
<center>
<img src="https://blogrpy.netlify.app/posts/pyr1/plt3.png">
</center>
</section><section id="ejemplo-3" class="level2"><h2 class="anchored" data-anchor-id="ejemplo-3">Ejemplo 3</h2>
<ul>
<li>Gráfico desde un <code>Dataframe</code>:</li>
</ul>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1">g3 <span class="op" style="color: #5E5E5E;">=</span> iris_py.plot(x <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Sepal.Length"</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Sepal.Width"</span>, kind <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"scatter"</span>,</span>
<span id="cb59-2">                  color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"red"</span>)                 </span>
<span id="cb59-3">g3</span></code></pre></div>
</details>
</div>
<center>
<img src="https://blogrpy.netlify.app/posts/pyr1/plt4.png">
</center>
</section></section><section id="modelo-con-scikit-learn" class="level1"><h1>Modelo con <code>scikit-learn</code>
</h1>
<ul>
<li><a href="https://www.datacamp.com/community/tutorials/decision-tree-classification-python">Ejemplo DataCamp</a></li>
<li><a href="https://www.kaggle.com/uciml/pima-indians-diabetes-database">Fuente de datos: PIMA</a></li>
<li><a href="https://scikit-learn.org/stable/"><code>scikit-learn</code></a></li>
</ul>
<section id="importando-módulos-de-python-1" class="level2"><h2 class="anchored" data-anchor-id="importando-módulos-de-python-1">Importando módulos de <em>python</em>
</h2>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><span class="im" style="color: #00769E;">import</span> pandas <span class="im" style="color: #00769E;">as</span> pd</span>
<span id="cb60-2"><span class="im" style="color: #00769E;">import</span> sklearn</span>
<span id="cb60-3"><span class="im" style="color: #00769E;">from</span> sklearn.tree <span class="im" style="color: #00769E;">import</span> DecisionTreeClassifier </span>
<span id="cb60-4"><span class="im" style="color: #00769E;">from</span> sklearn.model_selection <span class="im" style="color: #00769E;">import</span> train_test_split </span>
<span id="cb60-5"><span class="im" style="color: #00769E;">from</span> sklearn <span class="im" style="color: #00769E;">import</span> metrics </span></code></pre></div>
</details>
</div>
</section><section id="cargando-datos" class="level2"><h2 class="anchored" data-anchor-id="cargando-datos">Cargando datos</h2>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb61" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1">col_names <span class="op" style="color: #5E5E5E;">=</span> [<span class="st" style="color: #20794D;">'pregnant'</span>, <span class="st" style="color: #20794D;">'glucose'</span>, <span class="st" style="color: #20794D;">'bp'</span>, <span class="st" style="color: #20794D;">'skin'</span>, <span class="st" style="color: #20794D;">'insulin'</span>, <span class="st" style="color: #20794D;">'bmi'</span>, <span class="st" style="color: #20794D;">'pedigree'</span>,</span>
<span id="cb61-2">             <span class="st" style="color: #20794D;">'age'</span>, <span class="st" style="color: #20794D;">'label'</span>]</span>
<span id="cb61-3"><span class="co" style="color: #5E5E5E;"># load dataset</span></span>
<span id="cb61-4">pima <span class="op" style="color: #5E5E5E;">=</span> pd.read_csv(<span class="st" style="color: #20794D;">"diabetes.csv"</span>, header<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">None</span>, names<span class="op" style="color: #5E5E5E;">=</span>col_names)</span>
<span id="cb61-5">pima <span class="op" style="color: #5E5E5E;">=</span> pima[<span class="dv" style="color: #AD0000;">1</span>:]</span>
<span id="cb61-6">pima.head()</span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  pregnant glucose  bp skin insulin   bmi pedigree age label
1        6     148  72   35       0  33.6    0.627  50     1
2        1      85  66   29       0  26.6    0.351  31     0
3        8     183  64    0       0  23.3    0.672  32     1
4        1      89  66   23      94  28.1    0.167  21     0
5        0     137  40   35     168  43.1    2.288  33     1</code></pre>
</div>
</div>
</section><section id="selección-de-características" class="level2"><h2 class="anchored" data-anchor-id="selección-de-características">Selección de características</h2>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb63" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><span class="co" style="color: #5E5E5E;"># Fraccionando la base de datos en predictoras (X) y respuesta (Y)</span></span>
<span id="cb63-2">feature_cols <span class="op" style="color: #5E5E5E;">=</span> [<span class="st" style="color: #20794D;">'pregnant'</span>, <span class="st" style="color: #20794D;">'insulin'</span>, <span class="st" style="color: #20794D;">'bmi'</span>, <span class="st" style="color: #20794D;">'age'</span>,<span class="st" style="color: #20794D;">'glucose'</span>,<span class="st" style="color: #20794D;">'bp'</span>,<span class="st" style="color: #20794D;">'pedigree'</span>]</span>
<span id="cb63-3">X <span class="op" style="color: #5E5E5E;">=</span> pima[feature_cols] </span>
<span id="cb63-4">y <span class="op" style="color: #5E5E5E;">=</span> pima.label</span></code></pre></div>
</details>
</div>
</section><section id="train---test" class="level2"><h2 class="anchored" data-anchor-id="train---test">Train - Test</h2>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1">X_train, X_test, y_train, y_test <span class="op" style="color: #5E5E5E;">=</span> train_test_split(X, y, test_size<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">0.3</span>, random_state<span class="op" style="color: #5E5E5E;">=</span><span class="dv" style="color: #AD0000;">1</span>)</span></code></pre></div>
</details>
</div>
</section><section id="construyendo-modelo" class="level2"><h2 class="anchored" data-anchor-id="construyendo-modelo">Construyendo Modelo</h2>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><span class="co" style="color: #5E5E5E;"># Clasificador</span></span>
<span id="cb65-2">clf <span class="op" style="color: #5E5E5E;">=</span> DecisionTreeClassifier()</span>
<span id="cb65-3"></span>
<span id="cb65-4"><span class="co" style="color: #5E5E5E;"># Clasificador en train --&gt; Entrenando modelo</span></span>
<span id="cb65-5">clf_fit <span class="op" style="color: #5E5E5E;">=</span> clf.fit(X <span class="op" style="color: #5E5E5E;">=</span> X_train, y <span class="op" style="color: #5E5E5E;">=</span> y_train)</span></code></pre></div>
</details>
</div>
</section><section id="evaluación-del-modelo" class="level2"><h2 class="anchored" data-anchor-id="evaluación-del-modelo">Evaluación del modelo</h2>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><span class="co" style="color: #5E5E5E;"># Predicciones</span></span>
<span id="cb66-2">y_pred <span class="op" style="color: #5E5E5E;">=</span> clf_fit.predict(X_test)</span>
<span id="cb66-3"><span class="bu" style="color: null;">print</span>(<span class="st" style="color: #20794D;">"Accuracy:"</span>, metrics.accuracy_score(y_test, y_pred))</span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.6753246753246753</code></pre>
</div>
</div>


<!-- -->

</section></section> ]]></description>
  <category>R</category>
  <category>Python</category>
  <category>Programación</category>
  <guid>https://blogrpy.netlify.app/posts/pyr1/Py_R_1.html</guid>
  <pubDate>Mon, 20 Jan 2020 05:00:00 GMT</pubDate>
  <media:content url="https://blogrpy.netlify.app/posts/pyr1/img.png" medium="image" type="image/png" height="101" width="144"/>
</item>
</channel>
</rss>
